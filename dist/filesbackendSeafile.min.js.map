{"version":3,"sources":["filesbackendSeafile-debug.js"],"names":["Ext","namespace","Zarafa","plugins","files","backend","Seafile","SeafileBackend","extend","core","Plugin","constructor","config","superclass","call","this","initPlugin","apply","arguments","registerInsertionPoint","createShareDialogInsertionPoint","data","SharedComponentType","addProperty","xtype","bidSharedComponent","type","record","bid","getSharedComponent","component","ui","FilesShareUserEditContentPanel","onReady","container","registerPlugin","PluginMetaData","name","displayName","dgettext","allowUserDisable","pluginConstructor","RecipientTypes","Enum","create","USER","GROUP","LINK","ResponseHandler","AbstractResponseHandler","successCallback","failureCallback","doLoadsharingdetails","response","doCreatenewshare","doDeleteexistingshare","doUpdateexistingshare","doError","common","dialogs","MessageBox","show","title","header","msg","message","icon","ERROR","buttons","OK","reg","ShareGridRecord","Record","ShareGridStore","ArrayStore","fileType","fields","ux","CopyButton","Button","zclipboard","undefined","completeText","swfPath","init","ZeroClipboard","moviePath","afterRender","clip","getEl","dom","on","onCopyComplete","createDelegate","onDataRequested","onDestroy","destroy","client","args","setText","getValue","alert","setValue","value","String","window","currentElement","matcherRegex","replacerFn","_extractAllDomains","_accessLevelLookup","flashState","bridge","version","disabled","outdated","ready","_clipData","clientIdCounter","_clientMeta","elementIdCounter","_elementMeta","_amdModuleId","_cjsModuleId","_swfPath","i","jsDir","tmpJsPath","jsPath","document","currentScript","src","scripts","getElementsByTagName","length","readyState","split","slice","lastIndexOf","_camelizeCssPropName","match","group","toUpperCase","prop","replace","_elementMouseOver","event","target","srcElement","activate","_addClass","element","nodeType","classList","contains","add","classNames","className","setClass","c","cl","indexOf","_removeClass","remove","_getDOMObjectPosition","obj","defaultZIndex","info","left","top","width","height","zIndex","_getSafeZIndex","getBoundingClientRect","pageXOffset","pageYOffset","zoomFactor","rect","physicalWidth","logicalWidth","body","right","offsetWidth","Math","round","_getZoomFactor","documentElement","scrollLeft","scrollTop","leftBorderWidth","clientLeft","topBorderWidth","clientTop","bottom","_inArray","elem","array","fromIndex","len","hasOwnProperty","_prepClip","elements","TypeError","_dispatchCallback","func","context","async","setTimeout","val","tmp","parseInt","isNaN","_globalConfig","_deprecationWarning","deprecatedApiName","debugEnabled","console","warn","log","deprecationWarning","_extend","arg","copy","_extractDomain","originOrUrl","protocolIndex","pathIndex","toLowerCase","_determineScriptAccess","origins","resultsArray","push","always","samedomain","never","currentDomain","configOptions","asaLower","allowScriptAccess","test","swfDomain","trustedDomains","trustedOrigins","_objectKeys","Object","keys","_detectFlashSupport","hasFlash","ActiveXObject","error","navigator","mimeTypes","_parseFlashVersion","flashVersion","_isFlashVersionSupported","parseFloat","options","id","instance","handlers","debug","_bridge","prototype","newText","setSize","_setHandCursor","enabled","setHandCursor","unclip","off","location","host","cacheBust","forceHandCursor","autoActivate","clientId","deactivate","htmlBridge","_getHtmlBridge","parentNode","removeChild","hoverClass","activeClass","_reposition","newTitle","getAttribute","setAttribute","el","camelProp","useHandCursor","getComputedStyle","getPropertyValue","currentStyle","style","tagName","removeAttribute","flashBridge","path","getElementById","opts","jsModuleId","flashvars","domain","str","domains","trustedOriginsExpanded","concat","protocol","encodeURIComponent","join","_vars","swfUrl","useNoCache","Date","getTime","html","createElement","position","appendChild","innerHTML","children","lastElementChild","isFlashElement","nodeName","pos","eventName","events","added","noflash","_receiveEvent","wrongflash","load","foundIndex","perEventHandlers","splice","zcClippingId","method","addEventListener","attachEvent","clippedElements","meta","arrayIndex","clientIds","removeEventListener","detachEvent","detectFlashSupport","dispatch","cleanEventName","clients","elementMetaId","_getAllClientsClippedToElement","_getAllClients","reposition","receiveEvent","setCurrent","resetBridge","setTitle","setDefaults","cleanVersion","performCallbackAsync","targetId","targetEl","textContent","innerText","defaultText","_deleteOwnProperties","activeElement","err","_safeActiveElement","focus","originalContext","handleEvent","define","amd","require","exports","module","FilesShareDialogPanel","SharePanel","loadMask","passwordChanged","expirationDateChanged","pubUploadChanged","linkShareID","recordId","parentRecord","ownerCt","records","get","isDefined","singleton","ShareStore","setupGridStoreListeners","applyIf","items","autoHeight","ref","fieldLabel","boxLabel","inputValue","marginTop","marginLeft","listeners","check","onShareViaLinkChecked","scope","hidden","layout","border","defaults","anchor","columnWidth","selectOnFocus","readOnly","iconCls","getPublicLinkValue","onUsePasswordChecked","inputType","change","onPasswordChange","keyup","onAllowEditingChecked","onUseExpirationDateChecked","minValue","format","onExpirationDateChange","text","handler","onDoneButtonClick","onCancel","afterrender","checkSharedRecord","store","getStore","onGridStoreAdd","onGridStoreUpdate","onGridStoreRemove","removeShareByID","updateExistingShare","createShare","checkbox","checked","linkfieldset","createShareByLink","hide","passwordfield","field","expirationfield","dialog","close","linkfield","closeDialog","un","closeLoadMask","linkcheckbox","LoadMask","FileTypes","FOLDER","editcheckbox","initSharedRecord","recIds","getRequest","singleRequest","initGuiFromSharedRecord","shares","shareid","share","shareType","suspendEvents","resumeEvents","url","isEmpty","expiration","expirationcheckbox","dt","shareWith","passwordcheckbox","permissions","addGroup","addUser","doneButton","setDisabled","shareOpts","shareByLinkCreated","set","accId","getAccount","accountid","shareByIDRemoved","index","getPermissions","shareWithDisplayname","shareCreated","shareFailed","getRawValue","shareByLinkUpdated","ContentPanel","closeOnSave","model","autoSave","FilesShareUserEditPanel","form","FormPanel","labelAlign","defaultType","createPanelItems","doSave","doClose","recipientRecord","getAt","selectedIndex","beginEdit","display_name","permissionShare","permissionChange","permissionCreate","permissionDelete","endEdit","recordType","permissionItems","allowBlank","mode","labelWidth","FilesShareUserGrid","grid","GridPanel","baseCls","enableHdMenu","initLoadMask","viewConfig","initViewConfig","sm","initSelectionModel","cm","initColumnModel","rowdblclick","onRowDblClick","tbar","onAdd","onDelete","enableRowBody","forceFit","emptyText","deferEmptyText","RowSelectionModel","singleSelect","selectionchange","onRowSelected","FilesShareUserGridColumnModel","selectionModel","removeAccountBtn","getCount","rowIndex","UIFactory","openLayerComponent","manager","WindowMgr","btn","button","rec","getSelectionModel","getSelected","ColumnModel","defaultColumns","createDefaultColumns","columns","sortable","dataIndex","flex","tooltip","align","renderer","shareTypeRenderer","yesNoRenderer","p","css","UserGroupPredictorField","ComboBox","recipientStore","proxy","HttpProxy","getBasePath","baseParams","displayField","typeAhead","forceSelection","triggerAction","itemId","minChars","loadingText","listEmptyText","itemSelector","tpl","XTemplate","onSelect","onSuggestionSelect","invalid","onInvalid","setRawValue","collapse","isExpanded","removeAll","loadData"],"mappings":"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","file":"filesbackendSeafile.min.js","sourcesContent":["Ext.namespace('Zarafa.plugins.files.backend.Seafile');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.SeafileBackend\n * @extends Zarafa.core.Plugin\n *\n * Plugin for the Seafile backend. It requires the main files plugin.\n */\nZarafa.plugins.files.backend.Seafile.SeafileBackend = Ext.extend(Zarafa.core.Plugin, {\n\n\t/**\n\t * Constructor\n\t * @protected\n\t */\n\tconstructor: function (config) {\n\t\tconfig = config || {};\n\n\t\tZarafa.plugins.files.backend.Seafile.SeafileBackend.superclass.constructor.call(this, config);\n\t},\n\n\t/**\n\t * Initialze all insertion points.\n\t */\n\tinitPlugin: function () {\n\t\tZarafa.plugins.files.backend.Seafile.SeafileBackend.superclass.initPlugin.apply(this, arguments);\n\n\t\tthis.registerInsertionPoint('plugin.files.sharedialog', this.createShareDialogInsertionPoint, this);\n\n\t\t// Register common specific dialog types\n\t\tZarafa.core.data.SharedComponentType.addProperty('filesplugin.seafile.useredit');\n\t},\n\n\t/**\n\t * Callback for the plugin.files.sharedialog insertion point.\n\t *\n\t * @return {{xtype: string}}\n\t */\n\tcreateShareDialogInsertionPoint: function () {\n\t\treturn {\n\t\t\txtype: 'filesplugin.seafile.filessharedialogpanel'\n\t\t};\n\t},\n\n\t/**\n\t * Bid for the type of shared component\n\t * and the given record.\n\t * @param {Zarafa.core.data.SharedComponentType} type Type of component a context can bid for.\n\t * @param {Ext.data.Record} record Optionally passed record.\n\t * @return {Number} The bid for the shared component\n\t */\n\tbidSharedComponent: function (type, record) {\n\t\tvar bid = -1;\n\t\tswitch (type) {\n\t\t\tcase Zarafa.core.data.SharedComponentType['filesplugin.seafile.useredit']:\n\t\t\t\tbid = 1;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn bid;\n\t},\n\n\t/**\n\t * Will return the reference to the shared component.\n\t * Based on the type of component requested a component is returned.\n\t * @param {Zarafa.core.data.SharedComponentType} type Type of component a context can bid for.\n\t * @param {Ext.data.Record} record Optionally passed record.\n\t * @return {Ext.Component} Component\n\t */\n\tgetSharedComponent: function (type, record) {\n\t\tvar component;\n\t\tswitch (type) {\n\t\t\tcase Zarafa.core.data.SharedComponentType['filesplugin.seafile.useredit']:\n\t\t\t\tcomponent = Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn component;\n\t}\n});\n\n// Register plugin\nZarafa.onReady(function () {\n\tcontainer.registerPlugin(new Zarafa.core.PluginMetaData({\n\t\tname             : 'filesbackendSeafile', // this name must be in format \"filesbackend<Backendname>\"\n\t\tdisplayName      : dgettext('plugin_filesbackendSeafile', 'Files: Seafile Backend'),\n\t\tallowUserDisable : false, // don't allow to disable this plugin - files will get confused if it is disabled\n\t\tpluginConstructor: Zarafa.plugins.files.backend.Seafile.SeafileBackend\n\t}));\n});\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.data');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.data.RecipientTypes\n * @extends Zarafa.core.Enum\n *\n * Enum containing the different recipient types that are available in the Seafile backend.\n *\n * @singleton\n */\nZarafa.plugins.files.backend.Seafile.data.RecipientTypes = Zarafa.core.Enum.create({\n\n\t/**\n\t * RecipientType: user\n\t *\n\t * @property\n\t * @type Number\n\t */\n\tUSER: 0,\n\n\t/**\n\t * RecipientType: group\n\t *\n\t * @property\n\t * @type Number\n\t */\n\tGROUP: 1,\n\n\t/**\n\t * RecipientType: link\n\t *\n\t * @property\n\t * @type Number\n\t */\n\tLINK: 3\n});\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.data');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.data.ResponseHandler\n * @extends Zarafa.core.data.AbstractResponseHandler\n * @xtype filesplugin.seafile.responsehandler\n *\n * Files plugin specific response handler.\n */\nZarafa.plugins.files.backend.Seafile.data.ResponseHandler = Ext.extend(Zarafa.core.data.AbstractResponseHandler, {\n\t/**\n\t * @cfg {Function} successCallback The function which\n\t * will be called after success request.\n\t */\n\tsuccessCallback: null,\n\n\t/**\n\t * @cfg {Function} failureCallback The function which\n\t * will be called after a failed request.\n\t */\n\tfailureCallback: null,\n\n\t/**\n\t * Call the successCallback callback function.\n\t *\n\t * @param {Object} response Object contained the response data.\n\t */\n\tdoLoadsharingdetails: function (response) {\n\t\tthis.successCallback(response);\n\t},\n\n\t/**\n\t * Call the successCallback callback function.\n\t *\n\t * @param {Object} response Object contained the response data.\n\t */\n\tdoCreatenewshare: function (response) {\n\t\tthis.successCallback(response);\n\t},\n\n\t/**\n\t * Call the successCallback callback function.\n\t *\n\t * @param {Object} response Object contained the response data.\n\t */\n\tdoDeleteexistingshare: function (response) {\n\t\tthis.successCallback(response);\n\t},\n\n\t/**\n\t * Call the successCallback callback function.\n\t *\n\t * @param {Object} response Object contained the response data.\n\t */\n\tdoUpdateexistingshare: function (response) {\n\t\tthis.successCallback(response);\n\t},\n\n\t/**\n\t * In case exception happened on server, server will return\n\t * exception response with the code of exception.\n\t *\n\t * @param {Object} response Object contained the response data.\n\t */\n\tdoError: function (response) {\n\t\tZarafa.common.dialogs.MessageBox.show({\n\t\t\ttitle  : response.header,\n\t\t\tmsg    : response.message,\n\t\t\ticon   : Zarafa.common.dialogs.MessageBox.ERROR,\n\t\t\tbuttons: Zarafa.common.dialogs.MessageBox.OK\n\t\t});\n\t\tthis.failureCallback(response);\n\t}\n});\n\nExt.reg('filesplugin.seafile.responsehandler', Zarafa.plugins.files.backend.Seafile.data.ResponseHandler);\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.data');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.data.ShareGridRecord\n *\n * This class specifies the ShareGridRecord and it's fields.\n */\nZarafa.plugins.files.backend.Seafile.data.ShareGridRecord = Ext.data.Record.create(\n\t{name: \"id\", type: \"string\"},\n\t{name: \"shareWith\", type: \"string\"},\n\t{name: \"shareWithDisplayname\", type: \"string\"},\n\t{name: \"type\", type: \"string\"},\n\t{name: \"permissionCreate\", type: \"bool\"},\n\t{name: \"permissionChange\", type: \"bool\"},\n\t{name: \"permissionDelete\", type: \"bool\"},\n\t{name: \"permissionShare\", type: \"bool\"}\n);\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.data');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.data.ShareGridStore\n * @extends Ext.data.ArrayStore\n * @xtype filesplugin.seafile.sharegridstore\n *\n * This simple array store holds all group and user shares. Do not use the save or commit method as\n * the store does not implement a writer.\n */\nZarafa.plugins.files.backend.Seafile.data.ShareGridStore = Ext.extend(Ext.data.ArrayStore, {\n\t/**\n\t * @constructor\n\t */\n\tconstructor: function (fileType) {\n\t\tZarafa.plugins.files.backend.Seafile.data.ShareGridStore.superclass.constructor.call(this, {\n\t\t\tfields  : [\n\t\t\t\t'id', 'shareWith', 'shareWithDisplayname', 'type', 'permissionCreate', 'permissionChange', 'permissionDelete', 'permissionShare'\n\t\t\t],\n\t\t\tfileType: fileType\n\t\t});\n\t}\n});\n\nExt.reg('filesplugin.seafile.sharegridstore', Zarafa.plugins.files.backend.Seafile.data.ShareGridStore);\n\nExt.namespace('Ext.ux');\n\n/**\n * This class is a wrapper for the ZeroClipboard library.\n * It will only work with ZeroClipboard 1.3.x and ExtJS 3.4\n *\n * @author Kopano\n * @class Ext.ux.CopyButton\n * @extends Ext.Button\n * @xtype copybutton\n */\nExt.ux.CopyButton = Ext.extend(Ext.Button, {\n\t/**\n\t * @var ZeroClipboard clipboard client\n\t */\n\tzclipboard: undefined,\n\n\t/**\n\t * @var String Complete Text\n\t */\n\tcompleteText: \"Text copied to clipboard\",\n\n\t/**\n\t * @var String Path to SWF Object\n\t */\n\tswfPath: \"ZeroClipboard.swf\",\n\n\t/**\n\t * Constructor\n\t * @param config\n\t */\n\tconstructor: function(config) {\n\t\tconfig = config || {};\n\n\t\tExt.ux.CopyButton.superclass.constructor.call(this, config);\n\n\t\tthis.init();\n\t},\n\n\t/**\n\t * Init ZeroClipboard\n\t * @private\n\t */\n\tinit: function() {\n\t\tZeroClipboard.config({ moviePath: this.swfPath }); // set the swfPath\n\t\tthis.zclipboard = new ZeroClipboard();\n\t},\n\n\t/**\n\t * Afterrender callback, bind the clipboard to an dom element and add listeners\n\t */\n\tafterRender: function() {\n\t\tExt.ux.CopyButton.superclass.afterRender.call(this);\n\t\tthis.zclipboard.clip(this.getEl().dom);\n\n\t\tthis.zclipboard.on('complete', this.onCopyComplete.createDelegate(this));\n\t\tthis.zclipboard.on('dataRequested', this.onDataRequested.createDelegate(this));\n\t},\n\n\t/**\n\t * On destroy callback\n\t */\n\tonDestroy: function() {\n\t\tthis.zclipboard.destroy();\n\t\tExt.ux.CopyButton.superclass.onDestroy.call(this);\n\t},\n\n\t/**\n\t * onDataRequested callback\n\t *\n\t * @param client\n\t * @param args\n\t */\n\tonDataRequested: function (client, args) {\n\t\tclient.setText( this.getValue() );\n\t},\n\n\t/**\n\t * onCopyComplete callback\n\t *\n\t * @param client\n\t * @param args\n\t */\n\tonCopyComplete: function (client, args) {\n\t\talert(this.completeText);\n\t},\n\n\t/**\n\t * Sets the value that should be used when the button is pressed\n\t * @param {String} value The value to set\n\t */\n\tsetValue: function(value) {\n\t\tthis.value = String(value);\n\t},\n\n\t/**\n\t * Get the value that will be used when the user clicks the button\n\t * @return {String} value The value used to copy to the clipboard\n\t */\n\tgetValue: function() {\n\t\treturn this.value;\n\t}\n});\n\nExt.reg('copybutton', Ext.ux.CopyButton);\n\n/*!\n * ZeroClipboard\n * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.\n * Copyright (c) 2014 Jon Rohan, James M. Greene\n * Licensed MIT\n * http://zeroclipboard.org/\n * v1.3.5\n */\n(function(window) {\n\t\"use strict\";\n\tvar currentElement;\n\tvar flashState = {\n\t\tbridge: null,\n\t\tversion: \"0.0.0\",\n\t\tdisabled: null,\n\t\toutdated: null,\n\t\tready: null\n\t};\n\tvar _clipData = {};\n\tvar clientIdCounter = 0;\n\tvar _clientMeta = {};\n\tvar elementIdCounter = 0;\n\tvar _elementMeta = {};\n\tvar _amdModuleId = null;\n\tvar _cjsModuleId = null;\n\tvar _swfPath = function() {\n\t\tvar i, jsDir, tmpJsPath, jsPath, swfPath = \"ZeroClipboard.swf\";\n\t\tif (document.currentScript && (jsPath = document.currentScript.src)) {} else {\n\t\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\t\tif (\"readyState\" in scripts[0]) {\n\t\t\t\tfor (i = scripts.length; i--; ) {\n\t\t\t\t\tif (scripts[i].readyState === \"interactive\" && (jsPath = scripts[i].src)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (document.readyState === \"loading\") {\n\t\t\t\tjsPath = scripts[scripts.length - 1].src;\n\t\t\t} else {\n\t\t\t\tfor (i = scripts.length; i--; ) {\n\t\t\t\t\ttmpJsPath = scripts[i].src;\n\t\t\t\t\tif (!tmpJsPath) {\n\t\t\t\t\t\tjsDir = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttmpJsPath = tmpJsPath.split(\"#\")[0].split(\"?\")[0];\n\t\t\t\t\ttmpJsPath = tmpJsPath.slice(0, tmpJsPath.lastIndexOf(\"/\") + 1);\n\t\t\t\t\tif (jsDir == null) {\n\t\t\t\t\t\tjsDir = tmpJsPath;\n\t\t\t\t\t} else if (jsDir !== tmpJsPath) {\n\t\t\t\t\t\tjsDir = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (jsDir !== null) {\n\t\t\t\t\tjsPath = jsDir;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (jsPath) {\n\t\t\tjsPath = jsPath.split(\"#\")[0].split(\"?\")[0];\n\t\t\tswfPath = jsPath.slice(0, jsPath.lastIndexOf(\"/\") + 1) + swfPath;\n\t\t}\n\t\treturn swfPath;\n\t}();\n\tvar _camelizeCssPropName = function() {\n\t\tvar matcherRegex = /\\-([a-z])/g, replacerFn = function(match, group) {\n\t\t\treturn group.toUpperCase();\n\t\t};\n\t\treturn function(prop) {\n\t\t\treturn prop.replace(matcherRegex, replacerFn);\n\t\t};\n\t}();\n\tvar _getStyle = function(el, prop) {\n\t\tvar value, camelProp, tagName, possiblePointers, i, len;\n\t\tif (window.getComputedStyle) {\n\t\t\tvalue = window.getComputedStyle(el, null).getPropertyValue(prop);\n\t\t} else {\n\t\t\tcamelProp = _camelizeCssPropName(prop);\n\t\t\tif (el.currentStyle) {\n\t\t\t\tvalue = el.currentStyle[camelProp];\n\t\t\t} else {\n\t\t\t\tvalue = el.style[camelProp];\n\t\t\t}\n\t\t}\n\t\tif (prop === \"cursor\") {\n\t\t\tif (!value || value === \"auto\") {\n\t\t\t\ttagName = el.tagName.toLowerCase();\n\t\t\t\tif (tagName === \"a\") {\n\t\t\t\t\treturn \"pointer\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t};\n\tvar _elementMouseOver = function(event) {\n\t\tif (!event) {\n\t\t\tevent = window.event;\n\t\t}\n\t\tvar target;\n\t\tif (this !== window) {\n\t\t\ttarget = this;\n\t\t} else if (event.target) {\n\t\t\ttarget = event.target;\n\t\t} else if (event.srcElement) {\n\t\t\ttarget = event.srcElement;\n\t\t}\n\t\tZeroClipboard.activate(target);\n\t};\n\tvar _addEventHandler = function(element, method, func) {\n\t\tif (!element || element.nodeType !== 1) {\n\t\t\treturn;\n\t\t}\n\t\tif (element.addEventListener) {\n\t\t\telement.addEventListener(method, func, false);\n\t\t} else if (element.attachEvent) {\n\t\t\telement.attachEvent(\"on\" + method, func);\n\t\t}\n\t};\n\tvar _removeEventHandler = function(element, method, func) {\n\t\tif (!element || element.nodeType !== 1) {\n\t\t\treturn;\n\t\t}\n\t\tif (element.removeEventListener) {\n\t\t\telement.removeEventListener(method, func, false);\n\t\t} else if (element.detachEvent) {\n\t\t\telement.detachEvent(\"on\" + method, func);\n\t\t}\n\t};\n\tvar _addClass = function(element, value) {\n\t\tif (!element || element.nodeType !== 1) {\n\t\t\treturn element;\n\t\t}\n\t\tif (element.classList) {\n\t\t\tif (!element.classList.contains(value)) {\n\t\t\t\telement.classList.add(value);\n\t\t\t}\n\t\t\treturn element;\n\t\t}\n\t\tif (value && typeof value === \"string\") {\n\t\t\tvar classNames = (value || \"\").split(/\\s+/);\n\t\t\tif (element.nodeType === 1) {\n\t\t\t\tif (!element.className) {\n\t\t\t\t\telement.className = value;\n\t\t\t\t} else {\n\t\t\t\t\tvar className = \" \" + element.className + \" \", setClass = element.className;\n\t\t\t\t\tfor (var c = 0, cl = classNames.length; c < cl; c++) {\n\t\t\t\t\t\tif (className.indexOf(\" \" + classNames[c] + \" \") < 0) {\n\t\t\t\t\t\t\tsetClass += \" \" + classNames[c];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telement.className = setClass.replace(/^\\s+|\\s+$/g, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn element;\n\t};\n\tvar _removeClass = function(element, value) {\n\t\tif (!element || element.nodeType !== 1) {\n\t\t\treturn element;\n\t\t}\n\t\tif (element.classList) {\n\t\t\tif (element.classList.contains(value)) {\n\t\t\t\telement.classList.remove(value);\n\t\t\t}\n\t\t\treturn element;\n\t\t}\n\t\tif (value && typeof value === \"string\" || value === undefined) {\n\t\t\tvar classNames = (value || \"\").split(/\\s+/);\n\t\t\tif (element.nodeType === 1 && element.className) {\n\t\t\t\tif (value) {\n\t\t\t\t\tvar className = (\" \" + element.className + \" \").replace(/[\\n\\t]/g, \" \");\n\t\t\t\t\tfor (var c = 0, cl = classNames.length; c < cl; c++) {\n\t\t\t\t\t\tclassName = className.replace(\" \" + classNames[c] + \" \", \" \");\n\t\t\t\t\t}\n\t\t\t\t\telement.className = className.replace(/^\\s+|\\s+$/g, \"\");\n\t\t\t\t} else {\n\t\t\t\t\telement.className = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn element;\n\t};\n\tvar _getZoomFactor = function() {\n\t\tvar rect, physicalWidth, logicalWidth, zoomFactor = 1;\n\t\tif (typeof document.body.getBoundingClientRect === \"function\") {\n\t\t\trect = document.body.getBoundingClientRect();\n\t\t\tphysicalWidth = rect.right - rect.left;\n\t\t\tlogicalWidth = document.body.offsetWidth;\n\t\t\tzoomFactor = Math.round(physicalWidth / logicalWidth * 100) / 100;\n\t\t}\n\t\treturn zoomFactor;\n\t};\n\tvar _getDOMObjectPosition = function(obj, defaultZIndex) {\n\t\tvar info = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tzIndex: _getSafeZIndex(defaultZIndex) - 1\n\t\t};\n\t\tif (obj.getBoundingClientRect) {\n\t\t\tvar rect = obj.getBoundingClientRect();\n\t\t\tvar pageXOffset, pageYOffset, zoomFactor;\n\t\t\tif (\"pageXOffset\" in window && \"pageYOffset\" in window) {\n\t\t\t\tpageXOffset = window.pageXOffset;\n\t\t\t\tpageYOffset = window.pageYOffset;\n\t\t\t} else {\n\t\t\t\tzoomFactor = _getZoomFactor();\n\t\t\t\tpageXOffset = Math.round(document.documentElement.scrollLeft / zoomFactor);\n\t\t\t\tpageYOffset = Math.round(document.documentElement.scrollTop / zoomFactor);\n\t\t\t}\n\t\t\tvar leftBorderWidth = document.documentElement.clientLeft || 0;\n\t\t\tvar topBorderWidth = document.documentElement.clientTop || 0;\n\t\t\tinfo.left = rect.left + pageXOffset - leftBorderWidth;\n\t\t\tinfo.top = rect.top + pageYOffset - topBorderWidth;\n\t\t\tinfo.width = \"width\" in rect ? rect.width : rect.right - rect.left;\n\t\t\tinfo.height = \"height\" in rect ? rect.height : rect.bottom - rect.top;\n\t\t}\n\t\treturn info;\n\t};\n\tvar _cacheBust = function(path, options) {\n\t\tvar cacheBust = options == null || options && options.cacheBust === true && options.useNoCache === true;\n\t\tif (cacheBust) {\n\t\t\treturn (path.indexOf(\"?\") === -1 ? \"?\" : \"&\") + \"noCache=\" + new Date().getTime();\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t};\n\tvar _vars = function(options) {\n\t\tvar i, len, domain, str = [], domains = [], trustedOriginsExpanded = [];\n\t\tif (options.trustedOrigins) {\n\t\t\tif (typeof options.trustedOrigins === \"string\") {\n\t\t\t\tdomains.push(options.trustedOrigins);\n\t\t\t} else if (typeof options.trustedOrigins === \"object\" && \"length\" in options.trustedOrigins) {\n\t\t\t\tdomains = domains.concat(options.trustedOrigins);\n\t\t\t}\n\t\t}\n\t\tif (options.trustedDomains) {\n\t\t\tif (typeof options.trustedDomains === \"string\") {\n\t\t\t\tdomains.push(options.trustedDomains);\n\t\t\t} else if (typeof options.trustedDomains === \"object\" && \"length\" in options.trustedDomains) {\n\t\t\t\tdomains = domains.concat(options.trustedDomains);\n\t\t\t}\n\t\t}\n\t\tif (domains.length) {\n\t\t\tfor (i = 0, len = domains.length; i < len; i++) {\n\t\t\t\tif (domains.hasOwnProperty(i) && domains[i] && typeof domains[i] === \"string\") {\n\t\t\t\t\tdomain = _extractDomain(domains[i]);\n\t\t\t\t\tif (!domain) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (domain === \"*\") {\n\t\t\t\t\t\ttrustedOriginsExpanded = [ domain ];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttrustedOriginsExpanded.push.apply(trustedOriginsExpanded, [ domain, \"//\" + domain, window.location.protocol + \"//\" + domain ]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (trustedOriginsExpanded.length) {\n\t\t\tstr.push(\"trustedOrigins=\" + encodeURIComponent(trustedOriginsExpanded.join(\",\")));\n\t\t}\n\t\tif (typeof options.jsModuleId === \"string\" && options.jsModuleId) {\n\t\t\tstr.push(\"jsModuleId=\" + encodeURIComponent(options.jsModuleId));\n\t\t}\n\t\treturn str.join(\"&\");\n\t};\n\tvar _inArray = function(elem, array, fromIndex) {\n\t\tif (typeof array.indexOf === \"function\") {\n\t\t\treturn array.indexOf(elem, fromIndex);\n\t\t}\n\t\tvar i, len = array.length;\n\t\tif (typeof fromIndex === \"undefined\") {\n\t\t\tfromIndex = 0;\n\t\t} else if (fromIndex < 0) {\n\t\t\tfromIndex = len + fromIndex;\n\t\t}\n\t\tfor (i = fromIndex; i < len; i++) {\n\t\t\tif (array.hasOwnProperty(i) && array[i] === elem) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n\tvar _prepClip = function(elements) {\n\t\tif (typeof elements === \"string\") throw new TypeError(\"ZeroClipboard doesn't accept query strings.\");\n\t\tif (!elements.length) return [ elements ];\n\t\treturn elements;\n\t};\n\tvar _dispatchCallback = function(func, context, args, async) {\n\t\tif (async) {\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tfunc.apply(context, args);\n\t\t\t}, 0);\n\t\t} else {\n\t\t\tfunc.apply(context, args);\n\t\t}\n\t};\n\tvar _getSafeZIndex = function(val) {\n\t\tvar zIndex, tmp;\n\t\tif (val) {\n\t\t\tif (typeof val === \"number\" && val > 0) {\n\t\t\t\tzIndex = val;\n\t\t\t} else if (typeof val === \"string\" && (tmp = parseInt(val, 10)) && !isNaN(tmp) && tmp > 0) {\n\t\t\t\tzIndex = tmp;\n\t\t\t}\n\t\t}\n\t\tif (!zIndex) {\n\t\t\tif (typeof _globalConfig.zIndex === \"number\" && _globalConfig.zIndex > 0) {\n\t\t\t\tzIndex = _globalConfig.zIndex;\n\t\t\t} else if (typeof _globalConfig.zIndex === \"string\" && (tmp = parseInt(_globalConfig.zIndex, 10)) && !isNaN(tmp) && tmp > 0) {\n\t\t\t\tzIndex = tmp;\n\t\t\t}\n\t\t}\n\t\treturn zIndex || 0;\n\t};\n\tvar _deprecationWarning = function(deprecatedApiName, debugEnabled) {\n\t\tif (deprecatedApiName && debugEnabled !== false && typeof console !== \"undefined\" && console && (console.warn || console.log)) {\n\t\t\tvar deprecationWarning = \"`\" + deprecatedApiName + \"` is deprecated. See docs for more info:\\n\" + \"    https://github.com/zeroclipboard/zeroclipboard/blob/master/docs/instructions.md#deprecations\";\n\t\t\tif (console.warn) {\n\t\t\t\tconsole.warn(deprecationWarning);\n\t\t\t} else {\n\t\t\t\tconsole.log(deprecationWarning);\n\t\t\t}\n\t\t}\n\t};\n\tvar _extend = function() {\n\t\tvar i, len, arg, prop, src, copy, target = arguments[0] || {};\n\t\tfor (i = 1, len = arguments.length; i < len; i++) {\n\t\t\tif ((arg = arguments[i]) != null) {\n\t\t\t\tfor (prop in arg) {\n\t\t\t\t\tif (arg.hasOwnProperty(prop)) {\n\t\t\t\t\t\tsrc = target[prop];\n\t\t\t\t\t\tcopy = arg[prop];\n\t\t\t\t\t\tif (target === copy) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (copy !== undefined) {\n\t\t\t\t\t\t\ttarget[prop] = copy;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn target;\n\t};\n\tvar _extractDomain = function(originOrUrl) {\n\t\tif (originOrUrl == null || originOrUrl === \"\") {\n\t\t\treturn null;\n\t\t}\n\t\toriginOrUrl = originOrUrl.replace(/^\\s+|\\s+$/g, \"\");\n\t\tif (originOrUrl === \"\") {\n\t\t\treturn null;\n\t\t}\n\t\tvar protocolIndex = originOrUrl.indexOf(\"//\");\n\t\toriginOrUrl = protocolIndex === -1 ? originOrUrl : originOrUrl.slice(protocolIndex + 2);\n\t\tvar pathIndex = originOrUrl.indexOf(\"/\");\n\t\toriginOrUrl = pathIndex === -1 ? originOrUrl : protocolIndex === -1 || pathIndex === 0 ? null : originOrUrl.slice(0, pathIndex);\n\t\tif (originOrUrl && originOrUrl.slice(-4).toLowerCase() === \".swf\") {\n\t\t\treturn null;\n\t\t}\n\t\treturn originOrUrl || null;\n\t};\n\tvar _determineScriptAccess = function() {\n\t\tvar _extractAllDomains = function(origins, resultsArray) {\n\t\t\tvar i, len, tmp;\n\t\t\tif (origins != null && resultsArray[0] !== \"*\") {\n\t\t\t\tif (typeof origins === \"string\") {\n\t\t\t\t\torigins = [ origins ];\n\t\t\t\t}\n\t\t\t\tif (typeof origins === \"object\" && \"length\" in origins) {\n\t\t\t\t\tfor (i = 0, len = origins.length; i < len; i++) {\n\t\t\t\t\t\tif (origins.hasOwnProperty(i)) {\n\t\t\t\t\t\t\ttmp = _extractDomain(origins[i]);\n\t\t\t\t\t\t\tif (tmp) {\n\t\t\t\t\t\t\t\tif (tmp === \"*\") {\n\t\t\t\t\t\t\t\t\tresultsArray.length = 0;\n\t\t\t\t\t\t\t\t\tresultsArray.push(\"*\");\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (_inArray(tmp, resultsArray) === -1) {\n\t\t\t\t\t\t\t\t\tresultsArray.push(tmp);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tvar _accessLevelLookup = {\n\t\t\talways: \"always\",\n\t\t\tsamedomain: \"sameDomain\",\n\t\t\tnever: \"never\"\n\t\t};\n\t\treturn function(currentDomain, configOptions) {\n\t\t\tvar asaLower, allowScriptAccess = configOptions.allowScriptAccess;\n\t\t\tif (typeof allowScriptAccess === \"string\" && (asaLower = allowScriptAccess.toLowerCase()) && /^always|samedomain|never$/.test(asaLower)) {\n\t\t\t\treturn _accessLevelLookup[asaLower];\n\t\t\t}\n\t\t\tvar swfDomain = _extractDomain(configOptions.moviePath);\n\t\t\tif (swfDomain === null) {\n\t\t\t\tswfDomain = currentDomain;\n\t\t\t}\n\t\t\tvar trustedDomains = [];\n\t\t\t_extractAllDomains(configOptions.trustedOrigins, trustedDomains);\n\t\t\t_extractAllDomains(configOptions.trustedDomains, trustedDomains);\n\t\t\tvar len = trustedDomains.length;\n\t\t\tif (len > 0) {\n\t\t\t\tif (len === 1 && trustedDomains[0] === \"*\") {\n\t\t\t\t\treturn \"always\";\n\t\t\t\t}\n\t\t\t\tif (_inArray(currentDomain, trustedDomains) !== -1) {\n\t\t\t\t\tif (len === 1 && currentDomain === swfDomain) {\n\t\t\t\t\t\treturn \"sameDomain\";\n\t\t\t\t\t}\n\t\t\t\t\treturn \"always\";\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \"never\";\n\t\t};\n\t}();\n\tvar _objectKeys = function(obj) {\n\t\tif (obj == null) {\n\t\t\treturn [];\n\t\t}\n\t\tif (Object.keys) {\n\t\t\treturn Object.keys(obj);\n\t\t}\n\t\tvar keys = [];\n\t\tfor (var prop in obj) {\n\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\tkeys.push(prop);\n\t\t\t}\n\t\t}\n\t\treturn keys;\n\t};\n\tvar _deleteOwnProperties = function(obj) {\n\t\tif (obj) {\n\t\t\tfor (var prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\tdelete obj[prop];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn obj;\n\t};\n\tvar _safeActiveElement = function() {\n\t\ttry {\n\t\t\treturn document.activeElement;\n\t\t} catch (err) {}\n\t\treturn null;\n\t};\n\tvar _detectFlashSupport = function() {\n\t\tvar hasFlash = false;\n\t\tif (typeof flashState.disabled === \"boolean\") {\n\t\t\thasFlash = flashState.disabled === false;\n\t\t} else {\n\t\t\tif (typeof ActiveXObject === \"function\") {\n\t\t\t\ttry {\n\t\t\t\t\tif (new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")) {\n\t\t\t\t\t\thasFlash = true;\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {}\n\t\t\t}\n\t\t\tif (!hasFlash && navigator.mimeTypes[\"application/x-shockwave-flash\"]) {\n\t\t\t\thasFlash = true;\n\t\t\t}\n\t\t}\n\t\treturn hasFlash;\n\t};\n\tfunction _parseFlashVersion(flashVersion) {\n\t\treturn flashVersion.replace(/,/g, \".\").replace(/[^0-9\\.]/g, \"\");\n\t}\n\tfunction _isFlashVersionSupported(flashVersion) {\n\t\treturn parseFloat(_parseFlashVersion(flashVersion)) >= 10;\n\t}\n\tvar ZeroClipboard = function(elements, options) {\n\t\tif (!(this instanceof ZeroClipboard)) {\n\t\t\treturn new ZeroClipboard(elements, options);\n\t\t}\n\t\tthis.id = \"\" + clientIdCounter++;\n\t\t_clientMeta[this.id] = {\n\t\t\tinstance: this,\n\t\t\telements: [],\n\t\t\thandlers: {}\n\t\t};\n\t\tif (elements) {\n\t\t\tthis.clip(elements);\n\t\t}\n\t\tif (typeof options !== \"undefined\") {\n\t\t\t_deprecationWarning(\"new ZeroClipboard(elements, options)\", _globalConfig.debug);\n\t\t\tZeroClipboard.config(options);\n\t\t}\n\t\tthis.options = ZeroClipboard.config();\n\t\tif (typeof flashState.disabled !== \"boolean\") {\n\t\t\tflashState.disabled = !_detectFlashSupport();\n\t\t}\n\t\tif (flashState.disabled === false && flashState.outdated !== true) {\n\t\t\tif (flashState.bridge === null) {\n\t\t\t\tflashState.outdated = false;\n\t\t\t\tflashState.ready = false;\n\t\t\t\t_bridge();\n\t\t\t}\n\t\t}\n\t};\n\tZeroClipboard.prototype.setText = function(newText) {\n\t\tif (newText && newText !== \"\") {\n\t\t\t_clipData[\"text/plain\"] = newText;\n\t\t\tif (flashState.ready === true && flashState.bridge && typeof flashState.bridge.setText === \"function\") {\n\t\t\t\tflashState.bridge.setText(newText);\n\t\t\t} else {\n\t\t\t\tflashState.ready = false;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.setSize = function(width, height) {\n\t\tif (flashState.ready === true && flashState.bridge && typeof flashState.bridge.setSize === \"function\") {\n\t\t\tflashState.bridge.setSize(width, height);\n\t\t} else {\n\t\t\tflashState.ready = false;\n\t\t}\n\t\treturn this;\n\t};\n\tvar _setHandCursor = function(enabled) {\n\t\tif (flashState.ready === true && flashState.bridge && typeof flashState.bridge.setHandCursor === \"function\") {\n\t\t\tflashState.bridge.setHandCursor(enabled);\n\t\t} else {\n\t\t\tflashState.ready = false;\n\t\t}\n\t};\n\tZeroClipboard.prototype.destroy = function() {\n\t\tthis.unclip();\n\t\tthis.off();\n\t\tdelete _clientMeta[this.id];\n\t};\n\tvar _getAllClients = function() {\n\t\tvar i, len, client, clients = [], clientIds = _objectKeys(_clientMeta);\n\t\tfor (i = 0, len = clientIds.length; i < len; i++) {\n\t\t\tclient = _clientMeta[clientIds[i]].instance;\n\t\t\tif (client && client instanceof ZeroClipboard) {\n\t\t\t\tclients.push(client);\n\t\t\t}\n\t\t}\n\t\treturn clients;\n\t};\n\tZeroClipboard.version = \"1.3.5\";\n\tvar _globalConfig = {\n\t\tswfPath: _swfPath,\n\t\ttrustedDomains: window.location.host ? [ window.location.host ] : [],\n\t\tcacheBust: true,\n\t\tforceHandCursor: false,\n\t\tzIndex: 999999999,\n\t\tdebug: true,\n\t\ttitle: null,\n\t\tautoActivate: true\n\t};\n\tZeroClipboard.config = function(options) {\n\t\tif (typeof options === \"object\" && options !== null) {\n\t\t\t_extend(_globalConfig, options);\n\t\t}\n\t\tif (typeof options === \"string\" && options) {\n\t\t\tif (_globalConfig.hasOwnProperty(options)) {\n\t\t\t\treturn _globalConfig[options];\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tvar copy = {};\n\t\tfor (var prop in _globalConfig) {\n\t\t\tif (_globalConfig.hasOwnProperty(prop)) {\n\t\t\t\tif (typeof _globalConfig[prop] === \"object\" && _globalConfig[prop] !== null) {\n\t\t\t\t\tif (\"length\" in _globalConfig[prop]) {\n\t\t\t\t\t\tcopy[prop] = _globalConfig[prop].slice(0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcopy[prop] = _extend({}, _globalConfig[prop]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcopy[prop] = _globalConfig[prop];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn copy;\n\t};\n\tZeroClipboard.destroy = function() {\n\t\tZeroClipboard.deactivate();\n\t\tfor (var clientId in _clientMeta) {\n\t\t\tif (_clientMeta.hasOwnProperty(clientId) && _clientMeta[clientId]) {\n\t\t\t\tvar client = _clientMeta[clientId].instance;\n\t\t\t\tif (client && typeof client.destroy === \"function\") {\n\t\t\t\t\tclient.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar htmlBridge = _getHtmlBridge(flashState.bridge);\n\t\tif (htmlBridge && htmlBridge.parentNode) {\n\t\t\thtmlBridge.parentNode.removeChild(htmlBridge);\n\t\t\tflashState.ready = null;\n\t\t\tflashState.bridge = null;\n\t\t}\n\t};\n\tZeroClipboard.activate = function(element) {\n\t\tif (currentElement) {\n\t\t\t_removeClass(currentElement, _globalConfig.hoverClass);\n\t\t\t_removeClass(currentElement, _globalConfig.activeClass);\n\t\t}\n\t\tcurrentElement = element;\n\t\t_addClass(element, _globalConfig.hoverClass);\n\t\t_reposition();\n\t\tvar newTitle = _globalConfig.title || element.getAttribute(\"title\");\n\t\tif (newTitle) {\n\t\t\tvar htmlBridge = _getHtmlBridge(flashState.bridge);\n\t\t\tif (htmlBridge) {\n\t\t\t\thtmlBridge.setAttribute(\"title\", newTitle);\n\t\t\t}\n\t\t}\n\t\tvar useHandCursor = _globalConfig.forceHandCursor === true || _getStyle(element, \"cursor\") === \"pointer\";\n\t\t_setHandCursor(useHandCursor);\n\t};\n\tZeroClipboard.deactivate = function() {\n\t\tvar htmlBridge = _getHtmlBridge(flashState.bridge);\n\t\tif (htmlBridge) {\n\t\t\thtmlBridge.style.left = \"0px\";\n\t\t\thtmlBridge.style.top = \"-9999px\";\n\t\t\thtmlBridge.removeAttribute(\"title\");\n\t\t}\n\t\tif (currentElement) {\n\t\t\t_removeClass(currentElement, _globalConfig.hoverClass);\n\t\t\t_removeClass(currentElement, _globalConfig.activeClass);\n\t\t\tcurrentElement = null;\n\t\t}\n\t};\n\tvar _bridge = function() {\n\t\tvar flashBridge, len;\n\t\tvar container = document.getElementById(\"global-zeroclipboard-html-bridge\");\n\t\tif (!container) {\n\t\t\tvar opts = ZeroClipboard.config();\n\t\t\topts.jsModuleId = typeof _amdModuleId === \"string\" && _amdModuleId || typeof _cjsModuleId === \"string\" && _cjsModuleId || null;\n\t\t\tvar allowScriptAccess = _determineScriptAccess(window.location.host, _globalConfig);\n\t\t\tvar flashvars = _vars(opts);\n\t\t\tvar swfUrl = _globalConfig.moviePath + _cacheBust(_globalConfig.moviePath, _globalConfig);\n\t\t\tvar html = '      <object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" id=\"global-zeroclipboard-flash-bridge\" width=\"100%\" height=\"100%\">         <param name=\"movie\" value=\"' + swfUrl + '\"/>         <param name=\"allowScriptAccess\" value=\"' + allowScriptAccess + '\"/>         <param name=\"scale\" value=\"exactfit\"/>         <param name=\"loop\" value=\"false\"/>         <param name=\"menu\" value=\"false\"/>         <param name=\"quality\" value=\"best\" />         <param name=\"bgcolor\" value=\"#ffffff\"/>         <param name=\"wmode\" value=\"transparent\"/>         <param name=\"flashvars\" value=\"' + flashvars + '\"/>         <embed src=\"' + swfUrl + '\"           loop=\"false\" menu=\"false\"           quality=\"best\" bgcolor=\"#ffffff\"           width=\"100%\" height=\"100%\"           name=\"global-zeroclipboard-flash-bridge\"           allowScriptAccess=\"' + allowScriptAccess + '\"           allowFullScreen=\"false\"           type=\"application/x-shockwave-flash\"           wmode=\"transparent\"           pluginspage=\"http://www.macromedia.com/go/getflashplayer\"           flashvars=\"' + flashvars + '\"           scale=\"exactfit\">         </embed>       </object>';\n\t\t\tcontainer = document.createElement(\"div\");\n\t\t\tcontainer.id = \"global-zeroclipboard-html-bridge\";\n\t\t\tcontainer.setAttribute(\"class\", \"global-zeroclipboard-container\");\n\t\t\tcontainer.style.position = \"absolute\";\n\t\t\tcontainer.style.left = \"0px\";\n\t\t\tcontainer.style.top = \"-9999px\";\n\t\t\tcontainer.style.width = \"15px\";\n\t\t\tcontainer.style.height = \"15px\";\n\t\t\tcontainer.style.zIndex = \"\" + _getSafeZIndex(_globalConfig.zIndex);\n\t\t\tdocument.body.appendChild(container);\n\t\t\tcontainer.innerHTML = html;\n\t\t}\n\t\tflashBridge = document[\"global-zeroclipboard-flash-bridge\"];\n\t\tif (flashBridge && (len = flashBridge.length)) {\n\t\t\tflashBridge = flashBridge[len - 1];\n\t\t}\n\t\tflashState.bridge = flashBridge || container.children[0].lastElementChild;\n\t};\n\tvar _getHtmlBridge = function(flashBridge) {\n\t\tvar isFlashElement = /^OBJECT|EMBED$/;\n\t\tvar htmlBridge = flashBridge && flashBridge.parentNode;\n\t\twhile (htmlBridge && isFlashElement.test(htmlBridge.nodeName) && htmlBridge.parentNode) {\n\t\t\thtmlBridge = htmlBridge.parentNode;\n\t\t}\n\t\treturn htmlBridge || null;\n\t};\n\tvar _reposition = function() {\n\t\tif (currentElement) {\n\t\t\tvar pos = _getDOMObjectPosition(currentElement, _globalConfig.zIndex);\n\t\t\tvar htmlBridge = _getHtmlBridge(flashState.bridge);\n\t\t\tif (htmlBridge) {\n\t\t\t\thtmlBridge.style.top = pos.top + \"px\";\n\t\t\t\thtmlBridge.style.left = pos.left + \"px\";\n\t\t\t\thtmlBridge.style.width = pos.width + \"px\";\n\t\t\t\thtmlBridge.style.height = pos.height + \"px\";\n\t\t\t\thtmlBridge.style.zIndex = pos.zIndex + 1;\n\t\t\t}\n\t\t\tif (flashState.ready === true && flashState.bridge && typeof flashState.bridge.setSize === \"function\") {\n\t\t\t\tflashState.bridge.setSize(pos.width, pos.height);\n\t\t\t} else {\n\t\t\t\tflashState.ready = false;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.on = function(eventName, func) {\n\t\tvar i, len, events, added = {}, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;\n\t\tif (typeof eventName === \"string\" && eventName) {\n\t\t\tevents = eventName.toLowerCase().split(/\\s+/);\n\t\t} else if (typeof eventName === \"object\" && eventName && typeof func === \"undefined\") {\n\t\t\tfor (i in eventName) {\n\t\t\t\tif (eventName.hasOwnProperty(i) && typeof i === \"string\" && i && typeof eventName[i] === \"function\") {\n\t\t\t\t\tthis.on(i, eventName[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (events && events.length) {\n\t\t\tfor (i = 0, len = events.length; i < len; i++) {\n\t\t\t\teventName = events[i].replace(/^on/, \"\");\n\t\t\t\tadded[eventName] = true;\n\t\t\t\tif (!handlers[eventName]) {\n\t\t\t\t\thandlers[eventName] = [];\n\t\t\t\t}\n\t\t\t\thandlers[eventName].push(func);\n\t\t\t}\n\t\t\tif (added.noflash && flashState.disabled) {\n\t\t\t\t_receiveEvent.call(this, \"noflash\", {});\n\t\t\t}\n\t\t\tif (added.wrongflash && flashState.outdated) {\n\t\t\t\t_receiveEvent.call(this, \"wrongflash\", {\n\t\t\t\t\tflashVersion: flashState.version\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (added.load && flashState.ready) {\n\t\t\t\t_receiveEvent.call(this, \"load\", {\n\t\t\t\t\tflashVersion: flashState.version\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.off = function(eventName, func) {\n\t\tvar i, len, foundIndex, events, perEventHandlers, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;\n\t\tif (arguments.length === 0) {\n\t\t\tevents = _objectKeys(handlers);\n\t\t} else if (typeof eventName === \"string\" && eventName) {\n\t\t\tevents = eventName.split(/\\s+/);\n\t\t} else if (typeof eventName === \"object\" && eventName && typeof func === \"undefined\") {\n\t\t\tfor (i in eventName) {\n\t\t\t\tif (eventName.hasOwnProperty(i) && typeof i === \"string\" && i && typeof eventName[i] === \"function\") {\n\t\t\t\t\tthis.off(i, eventName[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (events && events.length) {\n\t\t\tfor (i = 0, len = events.length; i < len; i++) {\n\t\t\t\teventName = events[i].toLowerCase().replace(/^on/, \"\");\n\t\t\t\tperEventHandlers = handlers[eventName];\n\t\t\t\tif (perEventHandlers && perEventHandlers.length) {\n\t\t\t\t\tif (func) {\n\t\t\t\t\t\tfoundIndex = _inArray(func, perEventHandlers);\n\t\t\t\t\t\twhile (foundIndex !== -1) {\n\t\t\t\t\t\t\tperEventHandlers.splice(foundIndex, 1);\n\t\t\t\t\t\t\tfoundIndex = _inArray(func, perEventHandlers, foundIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\thandlers[eventName].length = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.handlers = function(eventName) {\n\t\tvar prop, copy = null, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;\n\t\tif (handlers) {\n\t\t\tif (typeof eventName === \"string\" && eventName) {\n\t\t\t\treturn handlers[eventName] ? handlers[eventName].slice(0) : null;\n\t\t\t}\n\t\t\tcopy = {};\n\t\t\tfor (prop in handlers) {\n\t\t\t\tif (handlers.hasOwnProperty(prop) && handlers[prop]) {\n\t\t\t\t\tcopy[prop] = handlers[prop].slice(0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn copy;\n\t};\n\tvar _dispatchClientCallbacks = function(eventName, context, args, async) {\n\t\tvar handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers[eventName];\n\t\tif (handlers && handlers.length) {\n\t\t\tvar i, len, func, originalContext = context || this;\n\t\t\tfor (i = 0, len = handlers.length; i < len; i++) {\n\t\t\t\tfunc = handlers[i];\n\t\t\t\tcontext = originalContext;\n\t\t\t\tif (typeof func === \"string\" && typeof window[func] === \"function\") {\n\t\t\t\t\tfunc = window[func];\n\t\t\t\t}\n\t\t\t\tif (typeof func === \"object\" && func && typeof func.handleEvent === \"function\") {\n\t\t\t\t\tcontext = func;\n\t\t\t\t\tfunc = func.handleEvent;\n\t\t\t\t}\n\t\t\t\tif (typeof func === \"function\") {\n\t\t\t\t\t_dispatchCallback(func, context, args, async);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.clip = function(elements) {\n\t\telements = _prepClip(elements);\n\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\tif (elements.hasOwnProperty(i) && elements[i] && elements[i].nodeType === 1) {\n\t\t\t\tif (!elements[i].zcClippingId) {\n\t\t\t\t\telements[i].zcClippingId = \"zcClippingId_\" + elementIdCounter++;\n\t\t\t\t\t_elementMeta[elements[i].zcClippingId] = [ this.id ];\n\t\t\t\t\tif (_globalConfig.autoActivate === true) {\n\t\t\t\t\t\t_addEventHandler(elements[i], \"mouseover\", _elementMouseOver);\n\t\t\t\t\t}\n\t\t\t\t} else if (_inArray(this.id, _elementMeta[elements[i].zcClippingId]) === -1) {\n\t\t\t\t\t_elementMeta[elements[i].zcClippingId].push(this.id);\n\t\t\t\t}\n\t\t\t\tvar clippedElements = _clientMeta[this.id].elements;\n\t\t\t\tif (_inArray(elements[i], clippedElements) === -1) {\n\t\t\t\t\tclippedElements.push(elements[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.unclip = function(elements) {\n\t\tvar meta = _clientMeta[this.id];\n\t\tif (meta) {\n\t\t\tvar clippedElements = meta.elements;\n\t\t\tvar arrayIndex;\n\t\t\tif (typeof elements === \"undefined\") {\n\t\t\t\telements = clippedElements.slice(0);\n\t\t\t} else {\n\t\t\t\telements = _prepClip(elements);\n\t\t\t}\n\t\t\tfor (var i = elements.length; i--; ) {\n\t\t\t\tif (elements.hasOwnProperty(i) && elements[i] && elements[i].nodeType === 1) {\n\t\t\t\t\tarrayIndex = 0;\n\t\t\t\t\twhile ((arrayIndex = _inArray(elements[i], clippedElements, arrayIndex)) !== -1) {\n\t\t\t\t\t\tclippedElements.splice(arrayIndex, 1);\n\t\t\t\t\t}\n\t\t\t\t\tvar clientIds = _elementMeta[elements[i].zcClippingId];\n\t\t\t\t\tif (clientIds) {\n\t\t\t\t\t\tarrayIndex = 0;\n\t\t\t\t\t\twhile ((arrayIndex = _inArray(this.id, clientIds, arrayIndex)) !== -1) {\n\t\t\t\t\t\t\tclientIds.splice(arrayIndex, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (clientIds.length === 0) {\n\t\t\t\t\t\t\tif (_globalConfig.autoActivate === true) {\n\t\t\t\t\t\t\t\t_removeEventHandler(elements[i], \"mouseover\", _elementMouseOver);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelete elements[i].zcClippingId;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.elements = function() {\n\t\tvar meta = _clientMeta[this.id];\n\t\treturn meta && meta.elements ? meta.elements.slice(0) : [];\n\t};\n\tvar _getAllClientsClippedToElement = function(element) {\n\t\tvar elementMetaId, clientIds, i, len, client, clients = [];\n\t\tif (element && element.nodeType === 1 && (elementMetaId = element.zcClippingId) && _elementMeta.hasOwnProperty(elementMetaId)) {\n\t\t\tclientIds = _elementMeta[elementMetaId];\n\t\t\tif (clientIds && clientIds.length) {\n\t\t\t\tfor (i = 0, len = clientIds.length; i < len; i++) {\n\t\t\t\t\tclient = _clientMeta[clientIds[i]].instance;\n\t\t\t\t\tif (client && client instanceof ZeroClipboard) {\n\t\t\t\t\t\tclients.push(client);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn clients;\n\t};\n\t_globalConfig.hoverClass = \"zeroclipboard-is-hover\";\n\t_globalConfig.activeClass = \"zeroclipboard-is-active\";\n\t_globalConfig.trustedOrigins = null;\n\t_globalConfig.allowScriptAccess = null;\n\t_globalConfig.useNoCache = true;\n\t_globalConfig.moviePath = \"ZeroClipboard.swf\";\n\tZeroClipboard.detectFlashSupport = function() {\n\t\t_deprecationWarning(\"ZeroClipboard.detectFlashSupport\", _globalConfig.debug);\n\t\treturn _detectFlashSupport();\n\t};\n\tZeroClipboard.dispatch = function(eventName, args) {\n\t\tif (typeof eventName === \"string\" && eventName) {\n\t\t\tvar cleanEventName = eventName.toLowerCase().replace(/^on/, \"\");\n\t\t\tif (cleanEventName) {\n\t\t\t\tvar clients = currentElement && _globalConfig.autoActivate === true ? _getAllClientsClippedToElement(currentElement) : _getAllClients();\n\t\t\t\tfor (var i = 0, len = clients.length; i < len; i++) {\n\t\t\t\t\t_receiveEvent.call(clients[i], cleanEventName, args);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tZeroClipboard.prototype.setHandCursor = function(enabled) {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.setHandCursor\", _globalConfig.debug);\n\t\tenabled = typeof enabled === \"boolean\" ? enabled : !!enabled;\n\t\t_setHandCursor(enabled);\n\t\t_globalConfig.forceHandCursor = enabled;\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.reposition = function() {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.reposition\", _globalConfig.debug);\n\t\treturn _reposition();\n\t};\n\tZeroClipboard.prototype.receiveEvent = function(eventName, args) {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.receiveEvent\", _globalConfig.debug);\n\t\tif (typeof eventName === \"string\" && eventName) {\n\t\t\tvar cleanEventName = eventName.toLowerCase().replace(/^on/, \"\");\n\t\t\tif (cleanEventName) {\n\t\t\t\t_receiveEvent.call(this, cleanEventName, args);\n\t\t\t}\n\t\t}\n\t};\n\tZeroClipboard.prototype.setCurrent = function(element) {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.setCurrent\", _globalConfig.debug);\n\t\tZeroClipboard.activate(element);\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.resetBridge = function() {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.resetBridge\", _globalConfig.debug);\n\t\tZeroClipboard.deactivate();\n\t\treturn this;\n\t};\n\tZeroClipboard.prototype.setTitle = function(newTitle) {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.setTitle\", _globalConfig.debug);\n\t\tnewTitle = newTitle || _globalConfig.title || currentElement && currentElement.getAttribute(\"title\");\n\t\tif (newTitle) {\n\t\t\tvar htmlBridge = _getHtmlBridge(flashState.bridge);\n\t\t\tif (htmlBridge) {\n\t\t\t\thtmlBridge.setAttribute(\"title\", newTitle);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\tZeroClipboard.setDefaults = function(options) {\n\t\t_deprecationWarning(\"ZeroClipboard.setDefaults\", _globalConfig.debug);\n\t\tZeroClipboard.config(options);\n\t};\n\tZeroClipboard.prototype.addEventListener = function(eventName, func) {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.addEventListener\", _globalConfig.debug);\n\t\treturn this.on(eventName, func);\n\t};\n\tZeroClipboard.prototype.removeEventListener = function(eventName, func) {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.removeEventListener\", _globalConfig.debug);\n\t\treturn this.off(eventName, func);\n\t};\n\tZeroClipboard.prototype.ready = function() {\n\t\t_deprecationWarning(\"ZeroClipboard.prototype.ready\", _globalConfig.debug);\n\t\treturn flashState.ready === true;\n\t};\n\tvar _receiveEvent = function(eventName, args) {\n\t\teventName = eventName.toLowerCase().replace(/^on/, \"\");\n\t\tvar cleanVersion = args && args.flashVersion && _parseFlashVersion(args.flashVersion) || null;\n\t\tvar element = currentElement;\n\t\tvar performCallbackAsync = true;\n\t\tswitch (eventName) {\n\t\t\tcase \"load\":\n\t\t\t\tif (cleanVersion) {\n\t\t\t\t\tif (!_isFlashVersionSupported(cleanVersion)) {\n\t\t\t\t\t\t_receiveEvent.call(this, \"onWrongFlash\", {\n\t\t\t\t\t\t\tflashVersion: cleanVersion\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tflashState.outdated = false;\n\t\t\t\t\tflashState.ready = true;\n\t\t\t\t\tflashState.version = cleanVersion;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"wrongflash\":\n\t\t\t\tif (cleanVersion && !_isFlashVersionSupported(cleanVersion)) {\n\t\t\t\t\tflashState.outdated = true;\n\t\t\t\t\tflashState.ready = false;\n\t\t\t\t\tflashState.version = cleanVersion;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"mouseover\":\n\t\t\t\t_addClass(element, _globalConfig.hoverClass);\n\t\t\t\tbreak;\n\n\t\t\tcase \"mouseout\":\n\t\t\t\tif (_globalConfig.autoActivate === true) {\n\t\t\t\t\tZeroClipboard.deactivate();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"mousedown\":\n\t\t\t\t_addClass(element, _globalConfig.activeClass);\n\t\t\t\tbreak;\n\n\t\t\tcase \"mouseup\":\n\t\t\t\t_removeClass(element, _globalConfig.activeClass);\n\t\t\t\tbreak;\n\n\t\t\tcase \"datarequested\":\n\t\t\t\tif (element) {\n\t\t\t\t\tvar targetId = element.getAttribute(\"data-clipboard-target\"), targetEl = !targetId ? null : document.getElementById(targetId);\n\t\t\t\t\tif (targetEl) {\n\t\t\t\t\t\tvar textContent = targetEl.value || targetEl.textContent || targetEl.innerText;\n\t\t\t\t\t\tif (textContent) {\n\t\t\t\t\t\t\tthis.setText(textContent);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar defaultText = element.getAttribute(\"data-clipboard-text\");\n\t\t\t\t\t\tif (defaultText) {\n\t\t\t\t\t\t\tthis.setText(defaultText);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tperformCallbackAsync = false;\n\t\t\t\tbreak;\n\n\t\t\tcase \"complete\":\n\t\t\t\t_deleteOwnProperties(_clipData);\n\t\t\t\tif (element && element !== _safeActiveElement() && element.focus) {\n\t\t\t\t\telement.focus();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\tvar context = element;\n\t\tvar eventArgs = [ this, args ];\n\t\treturn _dispatchClientCallbacks.call(this, eventName, context, eventArgs, performCallbackAsync);\n\t};\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine([ \"require\", \"exports\", \"module\" ], function(require, exports, module) {\n\t\t\t_amdModuleId = module && module.id || null;\n\t\t\treturn ZeroClipboard;\n\t\t});\n\t} else if (typeof module === \"object\" && module && typeof module.exports === \"object\" && module.exports && typeof window.require === \"function\") {\n\t\t_cjsModuleId = module.id || null;\n\t\tmodule.exports = ZeroClipboard;\n\t} else {\n\t\twindow.ZeroClipboard = ZeroClipboard;\n\t}\n})(function() {\n\treturn this;\n}());\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.ui');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.ui.FilesShareDialogPanel\n * @extends Zarafa.plugins.files.ui.dialogs.SharePanel\n * @xtype filesplugin.seafile.filessharedialogpanel\n *\n * The panel contains all logic and UI elements that are needed for the OCS sharing functionality.\n */\nZarafa.plugins.files.backend.Seafile.ui.FilesShareDialogPanel = Ext.extend(Zarafa.plugins.files.ui.dialogs.SharePanel, {\n\t/**\n\t * The loading mask of this panel\n\t * @property\n\t * @type Ext.LoadMask\n\t */\n\tloadMask: undefined,\n\n\t/**\n\t * Flag for the password field\n\t * @property\n\t * @type bool\n\t */\n\tpasswordChanged: false,\n\n\t/**\n\t * Flag for the date field\n\t * @property\n\t * @type bool\n\t */\n\texpirationDateChanged: false,\n\n\t/**\n\t * Flag for the edit checkbox\n\t * @property\n\t * @type bool\n\t */\n\tpubUploadChanged: false,\n\n\t/**\n\t * The id of the linkshare, -1 if no linkshare is set\n\t * @property\n\t * @type Number\n\t */\n\tlinkShareID: -1,\n\n\t/**\n\t * Id of the files record\n\t * @property\n\t * @type Number\n\t */\n\trecordId: undefined,\n\n\t/**\n\t * Parent files record\n\t * @property\n\t * @type {Ext.record}\n\t */\n\tparentRecord: undefined,\n\n\t/**\n\t * Constructor - init store and UI\n\t *\n\t * @constructor\n\t * @param {Object} config the configuration for this panel\n\t */\n\tconstructor: function (config) {\n\t\tconfig = config || {};\n\t\tvar contentPanel = config.ownerCt;\n\t\tvar record = contentPanel.records[0];\n\n\t\tvar type = record.get(\"type\");\n\t\tthis.recordId = Ext.isDefined(record.get(\"folder_id\")) ? record.get(\"folder_id\") : record.get(\"id\");\n\t\tthis.parentRecord = record;\n\n\t\tZarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.init(type);\n\t\tthis.setupGridStoreListeners();\n\n\n\t\tExt.applyIf(config, {\n\t\t\theight   : 450,\n\t\t\twidth    : 780,\n\t\t\titems    : [{\n\t\t\t\txtype     : \"fieldset\",\n\t\t\t\ttitle     : dgettext(\"plugin_filesbackendSeafile\", \"Share with user/group\"),\n\t\t\t\tautoHeight: true,\n\t\t\t\tref       : \"userfieldset\",\n\t\t\t\titems     : [{\n\t\t\t\t\txtype : \"filesplugin.seafile.filesshareusergrid\",\n\t\t\t\t\tref   : \"../usergrid\",\n\t\t\t\t\theight: 200,\n\t\t\t\t\trecordId: this.recordId\n\t\t\t\t}]\n\t\t\t}, {\n\t\t\t\txtype     : \"checkbox\",\n\t\t\t\tfieldLabel: \"\",\n\t\t\t\tboxLabel  : dgettext(\"plugin_filesbackendSeafile\", \"Share via link\"),\n\t\t\t\tref       : \"linkcheckbox\",\n\t\t\t\tinputValue: \"sharelink\",\n\t\t\t\tstyle: {\n\t\t\t\t\tmarginTop: '5px',\n\t\t\t\t\tmarginLeft: '6px'\n\t\t\t\t},\n\t\t\t\tlisteners : {\n\t\t\t\t\tcheck: this.onShareViaLinkChecked,\n\t\t\t\t\tscope:this\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\txtype     : \"fieldset\",\n\t\t\t\ttitle     : dgettext(\"plugin_filesbackendSeafile\", \"Share via link\"),\n\t\t\t\tautoHeight: true,\n\t\t\t\tref       : \"linkfieldset\",\n\t\t\t\thidden    : true,\n\t\t\t\titems     : [{\n\t\t\t\t\tlayout  : \"column\",\n\t\t\t\t\tborder  : false,\n\t\t\t\t\tdefaults: {\n\t\t\t\t\t\tborder: false\n\t\t\t\t\t},\n\t\t\t\t\tanchor  : \"0\",\n\t\t\t\t\titems   : [{\n\t\t\t\t\t\tcolumnWidth: 0.95,\n\t\t\t\t\t\tlayout     : \"form\",\n\t\t\t\t\t\titems      : {\n\t\t\t\t\t\t\txtype        : \"textfield\",\n\t\t\t\t\t\t\tfieldLabel   : dgettext(\"plugin_filesbackendSeafile\", \"Public link\"),\n\t\t\t\t\t\t\tref          : \"../../../linkfield\",\n\t\t\t\t\t\t\tanchor       : '100%',\n\t\t\t\t\t\t\tselectOnFocus: true,\n\t\t\t\t\t\t\treadOnly     : true\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcolumnWidth: 0.05,\n\t\t\t\t\t\titems      : {\n\t\t\t\t\t\t\txtype       : \"copybutton\",\n\t\t\t\t\t\t\tswfPath     : \"plugins/filesbackendSeafile/resources/flash/ZeroClipboard.swf\",\n\t\t\t\t\t\t\tcompleteText: dgettext(\"plugin_filesbackendSeafile\", \"Link copied to clipboard\"),\n\t\t\t\t\t\t\ticonCls     : \"icon_copy_clipboard\",\n\t\t\t\t\t\t\tgetValue    : this.getPublicLinkValue,\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}, {\n\t\t\t\t\txtype     : \"checkbox\",\n\t\t\t\t\tfieldLabel: dgettext(\"plugin_filesbackendSeafile\", \"Password protect\"),\n\t\t\t\t\tboxLabel  : \"\",\n\t\t\t\t\tref       : \"../passwordcheckbox\",\n\t\t\t\t\tinputValue: \"pwprotected\",\n\t\t\t\t\tlisteners : {\n\t\t\t\t\t\tcheck: this.onUsePasswordChecked,\n\t\t\t\t\t\tscope: this\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\txtype     : \"textfield\",\n\t\t\t\t\tfieldLabel: dgettext(\"plugin_filesbackendSeafile\", \"Password\"),\n\t\t\t\t\tref       : \"../passwordfield\",\n\t\t\t\t\thidden    : true,\n\t\t\t\t\tinputType : 'password',\n\t\t\t\t\tname      : \"textvalue\",\n\t\t\t\t\tlisteners : {\n\t\t\t\t\t\tchange: this.onPasswordChange,\n\t\t\t\t\t\tkeyup : this.onPasswordChange,\n\t\t\t\t\t\tscope: this\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\txtype     : \"checkbox\",\n\t\t\t\t\tfieldLabel: dgettext(\"plugin_filesbackendSeafile\", \"Public upload\"),\n\t\t\t\t\tboxLabel  : \"\",\n\t\t\t\t\thidden    : true,\n\t\t\t\t\tref       : \"../editcheckbox\",\n\t\t\t\t\tinputValue: \"allowediting\",\n\t\t\t\t\tlisteners : {\n\t\t\t\t\t\tcheck: this.onAllowEditingChecked,\n\t\t\t\t\t\tscope: this\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\txtype     : \"checkbox\",\n\t\t\t\t\tfieldLabel: dgettext(\"plugin_filesbackendSeafile\", \"Expiration date\"),\n\t\t\t\t\tboxLabel  : \"\",\n\t\t\t\t\tref       : \"../expirationcheckbox\",\n\t\t\t\t\tinputValue: \"useexpiration\",\n\t\t\t\t\tlisteners : {\n\t\t\t\t\t\tcheck: this.onUseExpirationDateChecked,\n\t\t\t\t\t\tscope: this\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\txtype     : \"datefield\",\n\t\t\t\t\tref       : \"../expirationfield\",\n\t\t\t\t\thidden    : true,\n\t\t\t\t\tfieldLabel: dgettext(\"plugin_filesbackendSeafile\", \"Date\"),\n\t\t\t\t\tminValue  : new Date(new Date().getTime() + (24 * 60 * 60 * 1000)), // tomorrow\n\t\t\t\t\twidth     : 170,\n\t\t\t\t\tformat    : 'Y-m-d',\n\t\t\t\t\tlisteners : {\n\t\t\t\t\t\tchange: this.onExpirationDateChange,\n\t\t\t\t\t\tkeyup : this.onExpirationDateChange,\n\t\t\t\t\t\tscope: this\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t}],\n\t\t\tbuttons  : [{\n\t\t\t\txtype  : 'button',\n\t\t\t\ttext   : dgettext('plugin_filesbackendSeafile', 'Ok'),\n\t\t\t\thandler: this.onDoneButtonClick,\n\t\t\t\tref     : \"../doneButton\",\n\t\t\t\tscope  : this\n\t\t\t}, {\n\t\t\t\txtype  : 'button',\n\t\t\t\ttext   : dgettext('plugin_filesbackendSeafile', 'Cancel'),\n\t\t\t\thandler: this.onCancel,\n\t\t\t\tscope  : this\n\t\t\t}],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: this.checkSharedRecord,\n\t\t\t\tscope: this\n\t\t\t}\n\t\t});\n\n\t\tZarafa.plugins.files.backend.Seafile.ui.FilesShareDialogPanel.superclass.constructor.call(this, config);\n\t},\n\n\t/**\n\t * Create the onUpdate and onRemove listeners for the {@link Zarafa.plugins.files.backend.Seafile.data.ShareGridStore ShareGridStore}.\n\t * @private\n\t */\n\tsetupGridStoreListeners: function () {\n\t\tvar store = Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.getStore();\n\t\tstore.on(\"add\", this.onGridStoreAdd, this);\n\t\tstore.on(\"update\", this.onGridStoreUpdate, this);\n\t\tstore.on(\"remove\", this.onGridStoreRemove, this);\n\t},\n\n\t/**\n\t * Eventhandler for the remove event of the {@link Zarafa.plugins.files.backend.Seafile.data.ShareGridStore ShareGridStore}.\n\t * If the shareid is set, it will remove the share from the backend.\n\t *\n\t * @param store the grid store holding share records\n\t * @param record the share record to remove\n\t * @private\n\t */\n\tonGridStoreRemove: function (store, record) {\n\t\t// check if an id is set - if so, remove the old share\n\t\tif (record.get(\"id\") !== \"\" && record.get(\"id\") !== -1) {\n\t\t\tthis.removeShareByID(record.get(\"id\"));\n\t\t}\n\t},\n\n\t/**\n\t * Eventhandler for the update event of the {@link Zarafa.plugins.files.backend.Seafile.data.ShareGridStore ShareGridStore}.\n\t * This will first remove the new dirty record and then create a new one. So the save function of the store is not used :)\n\t *\n\t * @param store the grid store holding share records\n\t * @param record the share record to update\n\t * @private\n\t */\n\tonGridStoreUpdate: function (store, record)\n\t{\n\t\tthis.updateExistingShare(record);\n\t},\n\n\t/**\n\t * Eventhandler for the add event of the {@link Zarafa.plugins.files.backend.Seafile.data.ShareGridStore ShareGridStore}.\n\t * This will add a new entry to the gridstore.\n\t *\n\t * @param store the grid store holding share records\n\t * @param records the share records to add\n\t * @private\n\t */\n\tonGridStoreAdd: function (store, records) {\n\t\t// Ignore the initial loading of the store\n\t\tif(records.length !== 1 || records[0].get(\"id\") !== -1) {\n\t\t\treturn true;\n\t\t}\n\t\tthis.createShare(records[0], store, false);\n\t},\n\n\t/**\n\t * Eventhandler for the checkbox change event.\n\t *\n\t * @param checkbox\n\t * @param checked\n\t * @private\n\t */\n\tonShareViaLinkChecked: function (checkbox, checked) {\n\t\tif (checked) {\n\t\t\tthis.linkfieldset.show();\n\n\t\t\t// create a new share\n\t\t\tthis.createShareByLink();\n\t\t} else {\n\t\t\tthis.linkfieldset.hide();\n\t\t\tthis.removeShareByID(this.linkShareID);\n\t\t\tthis.linkShareID = -1; // reset the id\n\t\t}\n\t},\n\n\t/**\n\t * Eventhandler for the checkbox change event.\n\t *\n\t * @param checkbox\n\t * @param checked\n\t * @private\n\t */\n\tonUsePasswordChecked: function (checkbox, checked) {\n\t\tif (checked) {\n\t\t\tthis.passwordfield.show();\n\t\t} else {\n\t\t\tthis.passwordfield.hide();\n\t\t}\n\t},\n\n\t/**\n\t * Eventhandler for the textfield change event.\n\t *\n\t * @param field\n\t * @param event\n\t * @private\n\t */\n\tonPasswordChange: function (field, event) {\n\t\tthis.passwordChanged = true;\n\t},\n\n\t/**\n\t * Eventhandler for the checkbox change event.\n\t *\n\t * @param checkbox\n\t * @param checked\n\t * @private\n\t */\n\tonAllowEditingChecked: function (checkbox, checked) {\n\t\tthis.pubUploadChanged = true;\n\t},\n\n\t/**\n\t * Eventhandler for the checkbox change event.\n\t *\n\t * @param checkbox\n\t * @param checked\n\t * @private\n\t */\n\tonUseExpirationDateChecked: function (checkbox, checked) {\n\t\tif (checked) {\n\t\t\tthis.expirationfield.show();\n\t\t} else {\n\t\t\tthis.expirationfield.hide();\n\t\t}\n\t},\n\n\t/**\n\t * Eventhandler for the datefield change event.\n\t *\n\t * @private\n\t */\n\tonExpirationDateChange: function () {\n\t\tthis.expirationDateChanged = true;\n\t},\n\n\t/**\n\t * Event handler which is triggered when the user presses the cancel\n\t * {@link Ext.Button button}. This will close this dialog.\n\t * @private\n\t */\n\tonCancel : function()\n\t{\n\t\tthis.dialog.close();\n\t},\n\n\t/**\n\t * Return the current value of the public link textfield.\n\t *\n\t * @return {String} the linkfield value\n\t */\n\tgetPublicLinkValue: function () {\n\t\treturn this.linkfield.getValue();\n\t},\n\n\t/**\n\t * Close the dialog and clean all eventhandlers.\n\t * @private\n\t */\n\tcloseDialog: function () {\n\t\tvar store = Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.getStore();\n\n\t\tstore.un(\"update\", this.onGridStoreUpdate, this);\n\t\tstore.un(\"remove\", this.onGridStoreRemove, this);\n\n\t\tthis.dialog.close();\n\t},\n\n\t/**\n\t * Close the loadmask\n\t * @private\n\t */\n\tcloseLoadMask: function () {\n\t\tthis.loadMask.hide();\n\t},\n\n\t/**\n\t * Eventhandler for the \"done\" button.\n\t * It will save all changes of the linkshare and close the dialog.\n\t * @private\n\t */\n\tonDoneButtonClick: function () {\n\n\t\t// check if we have a link or user/group share\n\t\tif (this.linkcheckbox.getValue()) { // we have a link share\n\t\t\t// check if we have to update the share\n\t\t\tthis.updateExistingShare();\n\t\t} else { // we have a user/group share\n\t\t\tthis.closeDialog();\n\t\t}\n\t},\n\n\t/**\n\t * This method checks the dialog records for existing shares. If shares were found, it will try to load the details.\n\t * @private\n\t */\n\tcheckSharedRecord: function () {\n\t\t// init loading mask after the panel was rendered\n\t\tthis.loadMask = new Ext.LoadMask(this.getEl(), {msg: dgettext(\"plugin_filesbackendSeafile\", \"Loading details...\")});\n\n\t\t// check if we have a shared record where we should load details\n\t\tif (Ext.isDefined(this.parentRecord)) {\n\n\t\t\t// enable the edit checkbox if we have a folder record\n\t\t\tif (this.parentRecord.get(\"type\") === Zarafa.plugins.files.data.FileTypes.FOLDER) {\n\t\t\t\tthis.editcheckbox.show();\n\t\t\t}\n\n\t\t\tif (this.parentRecord.get(\"isshared\") === true) {\n\t\t\t\tthis.initSharedRecord();\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * This method requests the sharedetails from the backend.\n\t * @private\n\t */\n\tinitSharedRecord: function () {\n\t\tthis.loadMask.show();\n\n\t\tvar recIds = [this.recordId];\n\n\t\tcontainer.getRequest().singleRequest(\n\t\t\t'filesbrowsermodule',\n\t\t\t'loadsharingdetails',\n\t\t\t{\n\t\t\t\trecords: recIds\n\t\t\t},\n\t\t\tnew Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({\n\t\t\t\tsuccessCallback: this.initGuiFromSharedRecord.createDelegate(this)\n\t\t\t})\n\t\t);\n\t},\n\n\t/**\n\t * Callback for the loadsharingdetails response. This function will initialize the UI with the given\n\t * share records.\n\t *\n\t * @param {Object} response the response object from the share record request\n\t * @private\n\t */\n\tinitGuiFromSharedRecord: function (response) {\n\t\tvar shares = response.shares[this.recordId];\n\n\t\tfor (var shareid in shares) {\n\t\t\tvar share = shares[shareid];\n\t\t\tif (share.shareType === Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.LINK ) {\n\t\t\t\t// store the id of this share\n\t\t\t\tthis.linkShareID = shareid;\n\n\t\t\t\t// change gui\n\t\t\t\tthis.linkfieldset.show();\n\t\t\t\tthis.linkcheckbox.suspendEvents(false); // Stop all events.\n\t\t\t\tthis.linkcheckbox.setValue(true); // check checkbox\n\t\t\t\tthis.linkcheckbox.resumeEvents(); // resume events\n\t\t\t\tthis.linkfield.setValue(share.url);\n\n\t\t\t\t// check expiration\n\t\t\t\tif (!Ext.isEmpty(share.expiration)) {\n\t\t\t\t\tthis.expirationcheckbox.setValue(true); // check checkbox\n\t\t\t\t\tvar dt = new Date(share.expiration);\n\t\t\t\t\tthis.expirationfield.setValue(dt);\n\t\t\t\t}\n\t\t\t\t// check password\n\t\t\t\tif (!Ext.isEmpty(share.shareWith)) {\n\t\t\t\t\tthis.passwordcheckbox.setValue(true); // check checkbox\n\t\t\t\t\tthis.passwordfield.setValue(\"******\");\n\t\t\t\t}\n\t\t\t\t//check permissions\n\t\t\t\tif (!Ext.isEmpty(share.permissions)) {\n\t\t\t\t\tif (parseInt(share.permissions, 10) === 7) {\n\t\t\t\t\t\tthis.editcheckbox.suspendEvents(false); // Stop all events.\n\t\t\t\t\t\tthis.editcheckbox.setValue(true); // check checkbox\n\t\t\t\t\t\tthis.editcheckbox.resumeEvents(); // resume events\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (share.shareType === Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.GROUP) {\n\t\t\t\tZarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.addGroup(share);\n\t\t\t} else {\n\t\t\t\tZarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.addUser(share);\n\t\t\t}\n\n\t\t\tthis.doneButton.setDisabled(false);\n\t\t}\n\n\t\tthis.loadMask.hide();\n\t},\n\n\t/**\n\t * This method will request the creation of a new linkshare from the backend.\n\t * @private\n\t */\n\tcreateShareByLink: function () {\n\t\tthis.loadMask.show();\n\n\t\tvar recIds = [this.recordId];\n\n\t\tvar shareOpts = {\n\t\t\tshareType: Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.LINK\n\t\t};\n\n\t\tcontainer.getRequest().singleRequest(\n\t\t\t'filesbrowsermodule',\n\t\t\t'createnewshare',\n\t\t\t{\n\t\t\t\trecords: recIds,\n\t\t\t\toptions: shareOpts\n\t\t\t},\n\t\t\tnew Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({\n\t\t\t\tsuccessCallback: this.shareByLinkCreated.createDelegate(this),\n\t\t\t\tfailureCallback: this.closeDialog.createDelegate(this)\n\t\t\t})\n\t\t);\n\t},\n\n\t/**\n\t * Callback for the createnewshare response. It will update the parent record and the UI.\n\t *\n\t * @param {Object} response the share link creation response\n\t * @private\n\t */\n\tshareByLinkCreated: function (response) {\n\t\tvar share = response.shares[this.recordId.replace(/\\/+$/g, \"\")];\n\t\tthis.linkfield.setValue(share[\"url\"]);\n\n\t\t// store the id of this share\n\t\tthis.linkShareID = share[\"id\"];\n\n\t\tvar recIds = this.parentRecord.get(\"sharedid\") || [];\n\t\trecIds.push(share[\"id\"]);\n\n\t\t// also update the parent record\n\t\tthis.parentRecord.set(\"sharedid\", recIds);\n\t\tthis.parentRecord.set(\"isshared\", true);\n\n\t\t// enable the done button\n\t\tthis.doneButton.setDisabled(false);\n\n\t\tthis.loadMask.hide();\n\t},\n\n\t/**\n\t * This method will request the deletion of a one share from the backend.\n\t * @private\n\t */\n\tremoveShareByID: function (id) {\n\t\tthis.loadMask.show();\n\t\tvar accId = this.parentRecord.getAccount().get(\"id\");\n\n\t\tcontainer.getRequest().singleRequest(\n\t\t\t'filesbrowsermodule',\n\t\t\t'deleteexistingshare',\n\t\t\t{\n\t\t\t\trecords  : [id],\n\t\t\t\taccountid: accId\n\t\t\t},\n\t\t\tnew Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({\n\t\t\t\tsuccessCallback: this.shareByIDRemoved.createDelegate(this, [id], true),\n\t\t\t\tfailureCallback: this.closeDialog.createDelegate(this)\n\t\t\t})\n\t\t);\n\t},\n\n\t/**\n\t * Callback for the deleteexistingshare response. It will update the parent record and the UI.\n\t *\n\t * @param {Object} response\n\t * @param {Number} id\n\t * @private\n\t */\n\tshareByIDRemoved: function (response, id) {\n\t\tvar recIds = this.parentRecord.get(\"sharedid\") || [];\n\t\tvar index = recIds.indexOf(id);\n\n\t\tif (index > -1) {\n\t\t\trecIds.splice(index, 1); // remove the id from the array\n\t\t}\n\n\t\t// also update the parent record\n\t\tthis.parentRecord.set(\"sharedid\", recIds);\n\n\t\tif (recIds.length == 0) {\n\t\t\tthis.parentRecord.set(\"isshared\", false);\n\t\t}\n\t\tthis.loadMask.hide();\n\t},\n\n\t/**\n\t * This method will request the creation or update of a user or group share from the backend.\n\t *\n\t * @param record holding data for the share to be create\n\t * @param store the gridstore\n\t * @private\n\t */\n\tcreateShare: function (record, store)\n\t{\n\t\tthis.loadMask.show();\n\t\tvar recIds = [this.recordId]; // we're only going to share one file\n\t\tvar permissions = this.getPermissions(record);\n\t\tvar shareOpts = {\n\t\t\tshareType: record.get(\"type\") === \"user\" ? Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.USER : Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.GROUP,\n\t\t\tshareWith: record.get(\"shareWith\"),\n\t\t\tpermissions: permissions,\n\t\t\tshareWithDisplayname: record.get(\"shareWithDisplayname\")\n\t\t};\n\n\t\tcontainer.getRequest().singleRequest(\n\t\t\t'filesbrowsermodule',\n\t\t\t'createnewshare',\n\t\t\t{\n\t\t\t\trecords: recIds,\n\t\t\t\toptions: shareOpts\n\t\t\t},\n\t\t\tnew Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({\n\t\t\t\tsuccessCallback: this.shareCreated.createDelegate(this, [shareOpts, record], true),\n\t\t\t\tfailureCallback: this.shareFailed.createDelegate(this, [store, record])\n\t\t\t})\n\t\t);\n\t},\n\n\t/**\n\t * successCallback for the createnewshare response. It will update the parent record and the UI.\n\t *\n\t * @param {Object} response the response object from the createnewshare request\n\t * @param {Object} shareOpts object with sharing options\n\t * @param {Ext.data.Record} record share options record.\n\t * @private\n\t */\n\tshareCreated: function (response, shareOpts, record)\n\t{\n\t\tvar share = response.shares[this.recordId.replace(/\\/+$/g, \"\")];\n\t\tvar recIds = this.parentRecord.get(\"sharedid\") || [];\n\t\trecIds.push(share[\"id\"]);\n\t\trecord.data.id = share[\"id\"];\n\n\t\t// update the parent record\n\t\tthis.parentRecord.set(\"sharedid\", recIds);\n\t\tthis.parentRecord.set(\"isshared\", true);\n\t\tshareOpts.id = share.id;\n\n\t\tthis.loadMask.hide();\n\t},\n\n\t/**\n\t * failureCallback for the createnewshare response. It will remove the record that has been tried to add.\n\t * @param store the grid store\n\t * @param record record that should be created\n\t * @private\n\t */\n\tshareFailed: function (store, record) {\n\t\tstore.remove(record);\n\t\t\t\tthis.loadMask.hide();\n\t\t},\n\n\t/**\n\t * This method will request the modification of the lin share options from the backend.\n\t *\n\t * @param {Ext.data.Record} record share options record.\n\t */\n\tupdateExistingShare: function (record)\n\t{\n\t\tthis.loadMask.show();\n\t\tvar shareOpts = {};\n\t\tvar records = [];\n\t\tif (Ext.isDefined(record)) {\n\t\t\tshareOpts[\"permissions\"] = this.getPermissions(record);\n\t\t\trecords.push(record.get(\"id\"));\n\t\t} else {\n\t\t\tif (this.passwordChanged) {\n\t\t\t\tshareOpts[\"password\"] = this.passwordfield.getValue();\n\t\t\t}\n\t\t\tif (!this.passwordcheckbox.getValue()) {\n\t\t\t\tshareOpts[\"password\"] = \"\";\n\t\t\t}\n\t\t\tif (this.pubUploadChanged) {\n\t\t\t\t// don't use publicUpload as this flag does not work (yet?) - ocs bug\n\n\t\t\t\tif (this.editcheckbox.getValue()) {\n\t\t\t\t\tshareOpts[\"permissions\"] = 7;\n\t\t\t\t} else {\n\t\t\t\t\tshareOpts[\"permissions\"] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.expirationDateChanged) {\n\t\t\t\tshareOpts[\"expireDate\"] = this.expirationfield.getRawValue();\n\t\t\t}\n\t\t\tif (!this.expirationcheckbox.getValue()) {\n\t\t\t\tshareOpts[\"expireDate\"] = \"\";\n\t\t\t}\n\t\t\trecords.push(this.linkShareID);\n\t\t}\n\n\t\tcontainer.getRequest().singleRequest(\n\t\t\t'filesbrowsermodule',\n\t\t\t'updateexistingshare',\n\t\t\t{\n\t\t\t\trecords: records,\n\t\t\t\taccountid: this.parentRecord.getAccount().get(\"id\"),\n\t\t\t\toptions: shareOpts\n\t\t\t},\n\t\t\tnew Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({\n\t\t\t\tsuccessCallback: this.shareByLinkUpdated.createDelegate(this, [record]),\n\t\t\t\tfailureCallback: this.closeLoadMask.createDelegate(this)\n\t\t\t})\n\t\t);\n\t},\n\n\t/**\n\t * Callback for the updateexistingshare response. This function simply closes the dialog.\n\t *\n\t * @param {Ext.data.Record} record share options record.\n\t * @private\n\t */\n\tshareByLinkUpdated: function (record)\n\t{\n\t\tthis.loadMask.hide();\n\t\tif (!Ext.isDefined(record)) {\n\t\t\tthis.closeDialog();\n\t\t}\n\t},\n\n\t/**\n\t * Helper function to get permission from record.\n\t *\n\t * @param {Ext.data.Record} record share options record.\n\t * @returns {number} permissions return calculated permissions.\n\t */\n\tgetPermissions: function (record)\n\t{\n\t\tvar permissions = 1;\n\t\tif (record.get(\"permissionChange\")) {\n\t\t\tpermissions += 2;\n\t\t}\n\t\tif (record.get(\"permissionCreate\")) {\n\t\t\tpermissions += 4;\n\t\t}\n\t\tif (record.get(\"permissionDelete\")) {\n\t\t\tpermissions += 8;\n\t\t}\n\t\tif (record.get(\"permissionShare\")) {\n\t\t\tpermissions += 16;\n\t\t}\n\n\t\treturn permissions;\n\t}\n});\n\nExt.reg('filesplugin.seafile.filessharedialogpanel', Zarafa.plugins.files.backend.Seafile.ui.FilesShareDialogPanel);\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.ui');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel\n * @extends Zarafa.core.ui.ContentPanel\n * @xtype filesplugin.seafile.filesshareusereditcontentpanel\n *\n * This content panel contains the sharing edit panel.\n */\nZarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel = Ext.extend(Zarafa.core.ui.ContentPanel, {\n\t/**\n\t * The load mask for this content panel\n\t * @property\n\t * @type Ext.LoadMask\n\t */\n\tloadMask: undefined,\n\n\t/**\n\t * @constructor\n\t * @param config\n\t */\n\tconstructor: function (config) {\n\t\tExt.applyIf(config, {\n\t\t\tlayout     : 'fit',\n\t\t\ttitle      : dgettext('plugin_filesbackendSeafile', 'Share Details'),\n\t\t\tcloseOnSave: true,\n\t\t\tmodel      : true,\n\t\t\tautoSave   : false,\n\t\t\twidth      : 480,\n\t\t\theight     : 445,\n\t\t\titems:{\n\t\t\t\txtype : 'filesplugin.seafile.filesshareusereditpanel',\n\t\t\t\trecord: config.record,\n\t\t\t\tstore : config.store,\n\t\t\t\trecordId: config.recordId\n\t\t\t}\n\t\t});\n\t\tZarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel.superclass.constructor.call(this, config);\n\t}\n});\n\nExt.reg('filesplugin.seafile.filesshareusereditcontentpanel', Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel);\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.ui');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel\n * @extends Ext.form.FormPanel\n * @xtype filesplugin.seafile.filesshareusereditpanel\n *\n * This content panel contains the sharing edit panel.\n */\nZarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel = Ext.extend(Ext.form.FormPanel, {\n\n\t/**\n\t * @cfg {Ext.record} Ext.record to be edited\n\t */\n\trecord : undefined,\n\n\t/**\n\t * @cfg {Ext.data.arrayStore} store holding the user and group share data\n\t */\n\tstore : undefined,\n\n\t/**\n\t * @cfg {String} record id of the parent files record\n\t */\n\trecordId: undefined,\n\n\t/**\n\t * @constructor\n\t * @param config\n\t */\n\tconstructor: function (config)\n\t{\n\t\tif (config.record) {\n\t\t\tthis.record = config.record;\n\t\t}\n\n\t\tif (config.store) {\n\t\t\tthis.store = config.store;\n\t\t}\n\n\t\tif (config.recordId) {\n\t\t\tthis.recordId = config.recordId;\n\t\t}\n\n\t\tExt.applyIf(config || {}, {\n\t\t\tlabelAlign : 'left',\n\t\t\tdefaultType: 'textfield',\n\t\t\titems      : this.createPanelItems(),\n\t\t\tbuttons    : [{\n\t\t\t\t\ttext   : dgettext('plugin_filesbackendSeafile', 'Save'),\n\t\t\t\t\thandler: this.doSave,\n\t\t\t\t\tscope  : this\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext   : dgettext('plugin_filesbackendSeafile', 'Cancel'),\n\t\t\t\t\thandler: this.doClose,\n\t\t\t\t\tscope  : this\n\t\t\t\t}]\n\t\t});\n\n\t\tZarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel.superclass.constructor.call(this, config);\n\t},\n\n\t/**\n\t * Eventhandler for the Cancel button, closing this dialog\n\t */\n\tdoClose: function ()\n\t{\n\t\tthis.ownerCt.dialog.close();\n\t},\n\n\t/**\n\t * Save the share data to the share gridstore.\n\t * Create a new record or update an existing one.\n\t */\n\tdoSave: function () {\n\t\tvar recipientRecord = this.shareWith.getStore().getAt(this.shareWith.selectedIndex);\n\t\tif (this.record) {\n\t\t\tthis.record.beginEdit();\n\t\t\t// When we have a recipientRecord here, this means the user has refreshed or changed it.\n\t\t\t// Otherwise we just keep the original values and update the permissions.\n\t\t\tif (recipientRecord) {\n\t\t\t\tthis.record.set('type', this.type.getValue());\n\t\t\t\tthis.record.set('shareWith', recipientRecord.data.shareWith);\n\t\t\t\tthis.record.set('shareWithDisplayname', recipientRecord.data.display_name);\n\t\t\t}\n\t\t\tthis.record.set('permissionShare', this.permissionShare.getValue());\n\t\t\tthis.record.set('permissionChange', this.permissionChange.getValue());\n\t\t\tthis.record.set('permissionCreate', this.store.fileType === Zarafa.plugins.files.data.FileTypes.FOLDER ? this.permissionCreate.getValue() : false);\n\t\t\tthis.record.set('permissionDelete', this.store.fileType === Zarafa.plugins.files.data.FileTypes.FOLDER ? this.permissionDelete.getValue() : false);\n\t\t\tthis.record.endEdit();\n\t\t} else {\n\t\t\tvar record = new this.store.recordType({\n\t\t\t\tid         : -1,\n\t\t\t\ttype  : this.type.getValue(),\n\t\t\t\tshareWith: recipientRecord.data.shareWith,\n\t\t\t\tshareWithDisplayname: recipientRecord.data.display_name,\n\t\t\t\tpermissionCreate    : this.store.fileType === Zarafa.plugins.files.data.FileTypes.FOLDER ? this.permissionCreate.getValue() : false,\n\t\t\t\tpermissionChange: this.permissionChange.getValue(),\n\t\t\t\tpermissionDelete  : this.store.fileType === Zarafa.plugins.files.data.FileTypes.FOLDER ? this.permissionDelete.getValue() : false,\n\t\t\t\tpermissionShare: this.permissionShare.getValue()\n\t\t\t});\n\t\t\tthis.store.add(record);\n\t\t}\n\t\tthis.ownerCt.dialog.close();\n\t},\n\n\t/**\n\t * Function will create panel items for {@link Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel FilesShareUserEditPanel}\n\t * @return {Array} array of items that should be added to panel.\n\t * @private\n\t */\n\tcreatePanelItems: function () {\n\t\tvar type = \"user\"; // user or group\n\t\tvar shareWithDisplayname = \"\"; // user/group displayname\n\t\tvar permissionCreate = false;\n\t\tvar permissionChange = false;\n\t\tvar permissionDelete = false;\n\t\tvar permissionShare = false;\n\t\tif (this.record) {\n\t\t\ttype = this.record.get('type');\n\t\t\tshareWithDisplayname = this.record.get('shareWithDisplayname');\n\t\t\tpermissionShare = this.record.get('permissionShare');\n\t\t\tpermissionChange = this.record.get('permissionChange');\n\t\t\tif (this.store.fileType === Zarafa.plugins.files.data.FileTypes.FOLDER) {\n\t\t\t\tpermissionCreate = this.record.get('permissionCreate');\n\t\t\t\tpermissionDelete = this.record.get('permissionDelete');\n\t\t\t}\n\t\t}\n\n\t\tvar permissionItems = [\n\t\t\t{\n\t\t\t\txtype     : 'checkbox',\n\t\t\t\tfieldLabel: dgettext('plugin_filesbackendSeafile', 'Re-share'),\n\t\t\t\tname      : 'permissionShare',\n\t\t\t\tref       : '../permissionShare',\n\t\t\t\tchecked   : permissionShare\n\t\t\t},\n\t\t\t{\n\t\t\t\txtype     : 'checkbox',\n\t\t\t\tfieldLabel: dgettext('plugin_filesbackendSeafile', 'Change'),\n\t\t\t\tname      : 'permissionChange',\n\t\t\t\tref       : '../permissionChange',\n\t\t\t\tchecked   : permissionChange\n\t\t\t}\n\t\t];\n\t\tif (this.store.fileType === Zarafa.plugins.files.data.FileTypes.FOLDER) {\n\t\t\tpermissionItems.push(\n\t\t\t\t{\n\t\t\t\t\txtype     : 'checkbox',\n\t\t\t\t\tfieldLabel: dgettext('plugin_filesbackendSeafile', 'Create'),\n\t\t\t\t\tname      : 'permissionCreate',\n\t\t\t\t\tref       : '../permissionCreate',\n\t\t\t\t\tchecked   : permissionCreate\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\txtype     : 'checkbox',\n\t\t\t\t\tfieldLabel: dgettext('plugin_filesbackendSeafile', 'Delete'),\n\t\t\t\t\tname      : 'permissionDelete',\n\t\t\t\t\tref       : '../permissionDelete',\n\t\t\t\t\tchecked   : permissionDelete\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn [\n\t\t\t{\n\t\t\t\txtype     : 'filesplugin.seafile.usergrouppredictorfield',\n\t\t\t\tfieldLabel: dgettext('plugin_filesbackendSeafile', 'Share with'),\n\t\t\t\tname      : 'shareWith',\n\t\t\t\tref       : 'shareWith',\n\t\t\t\tallowBlank: false,\n\t\t\t\tvalue     : shareWithDisplayname,\n\t\t\t\trecordId  : this.recordId\n\t\t\t},\n\t\t\t{\n\t\t\t\txtype     : 'selectbox',\n\t\t\t\tfieldLabel: dgettext('plugin_filesbackendSeafile', 'Type'),\n\t\t\t\tname      : 'type',\n\t\t\t\tref       : 'type',\n\t\t\t\tallowBlank: false,\n\t\t\t\tvalue     : type,\n\t\t\t\tstore     : [\n\t\t\t\t\t[\"user\", \"User\"],\n\t\t\t\t\t[\"group\", \"Group\"]\n\t\t\t\t],\n\t\t\t\tmode      : 'local'\n\t\t\t},\n\t\t\t{\n\t\t\t\txtype      : 'fieldset',\n\t\t\t\ttitle      : dgettext('plugin_filesbackendSeafile', 'Permissions'),\n\t\t\t\tdefaults   : {\n\t\t\t\t\tlabelWidth: 89,\n\t\t\t\t\tanchor    : '100%',\n\t\t\t\t\txtype     : 'textfield'\n\t\t\t\t},\n\t\t\t\titems      : permissionItems\n\t\t\t}\n\t\t];\n\t}\n});\n\nExt.reg('filesplugin.seafile.filesshareusereditpanel', Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel);\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.ui');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGrid\n * @extends Ext.grid.GridPanel\n * @xtype filesplugin.seafile.filesshareusergrid\n *\n * The main gridpanel for our share list. It will display user and group shares.\n */\nZarafa.plugins.files.backend.Seafile.ui.FilesShareUserGrid = Ext.extend(Ext.grid.GridPanel, {\n\n\t/**\n\t * @cfg {Object} The account store.\n\t */\n\tstore: undefined,\n\n  /**\n   * @cfg {Number} The parent record id\n   */\n  recordId: undefined,\n\n\t/**\n\t * @constructor\n\t * @param {Object} config\n\t */\n\tconstructor: function (config) {\n\t\tconfig = config || {};\n\n\t\tthis.store = Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.getStore();\n\n\t\tExt.applyIf(config, {\n\t\t\txtype       : 'filesplugin.seafile.filesshareusergrid',\n\t\t\tref         : 'sharegrid',\n\t\t\tstore       : this.store,\n\t\t\tborder      : false,\n\t\t\tbaseCls     : 'shareGrid',\n\t\t\tenableHdMenu: false,\n\t\t\tloadMask    : this.initLoadMask(),\n\t\t\tviewConfig  : this.initViewConfig(),\n\t\t\tsm          : this.initSelectionModel(),\n\t\t\tcm          : this.initColumnModel(),\n\t\t\tlisteners   : {\n\t\t\t\trowdblclick: this.onRowDblClick,\n\t\t\t\tscope      : this\n\t\t\t},\n\t\t\ttbar        : [{\n\t\t\t\ticonCls: 'filesplugin_icon_add',\n\t\t\t\ttext   : dgettext('plugin_filesbackendSeafile', 'Add'),\n\t\t\t\thandler: this.onAdd.createDelegate(this)\n\t\t\t}, '-', {\n\t\t\t\ticonCls : 'filesplugin_icon_delete',\n\t\t\t\ttext    : dgettext('plugin_filesbackendSeafile', 'Delete'),\n\t\t\t\tref     : '../removeAccountBtn',\n\t\t\t\tdisabled: true,\n\t\t\t\thandler : this.onDelete.createDelegate(this)\n\t\t\t}]\n\t\t});\n\n\t\tZarafa.plugins.files.backend.Seafile.ui.FilesShareUserGrid.superclass.constructor.call(this, config);\n\t},\n\n\t/**\n\t * Initialize the {@link Ext.grid.GridPanel.loadMask} field.\n\t *\n\t * @return {Ext.LoadMask} The configuration object for {@link Ext.LoadMask}\n\t * @private\n\t */\n\tinitLoadMask: function () {\n\t\treturn {\n\t\t\tmsg: dgettext('plugin_filesbackendSeafile', 'Loading users and groups') + '...'\n\t\t};\n\t},\n\n\t/**\n\t * Initialize the {@link Ext.grid.GridPanel#viewConfig} field.\n\t *\n\t * @return {Ext.grid.GridView} The configuration object for {@link Ext.grid.GridView}\n\t * @private\n\t */\n\tinitViewConfig: function () {\n\t\t// enableRowBody is used for enabling the rendering of\n\t\t// the second row in the compact view model. The actual\n\t\t// rendering is done in the function getRowClass.\n\t\t//\n\t\t// NOTE: Even though we default to the extended view,\n\t\t// enableRowBody must be enabled here. We disable it\n\t\t// later in onContextViewModeChange(). If we set false\n\t\t// here, and enable it later then the row body will never\n\t\t// be rendered. So disabling after initializing the data\n\t\t// with the rowBody works, but the opposite will not.\n\n\t\treturn {\n\t\t\tenableRowBody : false,\n\t\t\tforceFit      : true,\n\t\t\temptyText     : '<div class=\\'emptytext\\'>' + dgettext('plugin_filesbackendSeafile', 'Add users or groups to share files.') + '</div>',\n\t\t\tdeferEmptyText: false\n\t\t};\n\t},\n\n\t/**\n\t * Initialize the {@link Ext.grid.GridPanel.sm SelectionModel} field.\n\t *\n\t * @return {Ext.grid.RowSelectionModel} The subclass of {@link Ext.grid.AbstractSelectionModel}\n\t * @private\n\t */\n\tinitSelectionModel: function () {\n\t\treturn new Ext.grid.RowSelectionModel({\n\t\t\tsingleSelect: true,\n\t\t\tlisteners   : {\n\t\t\t\tselectionchange: this.onRowSelected\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Initialize the {@link Ext.grid.GridPanel.cm ColumnModel} field.\n\t *\n\t * @return {Ext.grid.ColumnModel} The {@link Ext.grid.ColumnModel} for this grid\n\t * @private\n\t */\n\tinitColumnModel: function () {\n\t\treturn new Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGridColumnModel({fileType: this.store.fileType});\n\t},\n\n\t/**\n\t * Function is called if a row in the grid gets selected.\n\t *\n\t * @param selectionModel\n\t * @private\n\t */\n\tonRowSelected: function (selectionModel) {\n\t\tvar remButton = this.grid.removeAccountBtn;\n\t\tremButton.setDisabled(selectionModel.getCount() != 1);\n\t},\n\n\t/**\n\t * Eventhandler that is triggered if a grid row gets double clicked. It will open the user edit dialog.\n\t *\n\t * @param grid the grid holding the share records\n\t * @param rowIndex index of the currently selected record\n\t */\n\tonRowDblClick: function (grid, rowIndex) {\n\t\tZarafa.core.data.UIFactory.openLayerComponent(Zarafa.core.data.SharedComponentType['filesplugin.seafile.useredit'], undefined, {\n\t\t\tstore  : grid.getStore(),\n\t\t\trecord : grid.getStore().getAt(rowIndex),\n\t\t\tmanager: Ext.WindowMgr,\n\t\t\trecordId: this.recordId\n\t\t});\n\t},\n\n\t/**\n\t * Eventhandler for the add button. It will create a new grid entry and starts the editor for the newly created\n\t * entry.\n\t *\n\t * @param btn\n\t * @param event\n\t * @private\n\t */\n\tonAdd: function (btn, event) {\n\t\tZarafa.core.data.UIFactory.openLayerComponent(Zarafa.core.data.SharedComponentType['filesplugin.seafile.useredit'], undefined, {\n\t\t\tstore  : this.store,\n\t\t\tmanager: Ext.WindowMgr,\n\t\t\trecordId: this.recordId\n\t\t});\n\t},\n\n\t/**\n\t * Eventhandler for the delete button. It will remove the selected record from the grid.\n\t *\n\t * @param button\n\t * @param event\n\t * @private\n\t */\n\tonDelete: function (button, event) {\n\t\tvar rec = this.getSelectionModel().getSelected();\n\t\tif (!rec) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.store.remove(rec);\n\t}\n});\n\nExt.reg('filesplugin.seafile.filesshareusergrid', Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGrid);\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.ui');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGridColumnModel\n * @extends Zarafa.common.ui.grid.ColumnModel\n *\n * The Column model for the share grid.\n */\nZarafa.plugins.files.backend.Seafile.ui.FilesShareUserGridColumnModel = Ext.extend(Zarafa.common.ui.grid.ColumnModel, {\n\n\t/**\n\t * @constructor\n\t * @param config Configuration structure\n\t */\n\tconstructor: function (config) {\n\t\tconfig = config || {};\n\n\t\tthis.defaultColumns = this.createDefaultColumns(config.fileType);\n\n\t\tExt.applyIf(config, {\n\t\t\tcolumns : this.defaultColumns,\n\t\t\tdefaults: {\n\t\t\t\tsortable: true\n\t\t\t}\n\t\t});\n\t\tExt.apply(this, config);\n\n\t\tZarafa.plugins.files.backend.Seafile.ui.FilesShareUserGridColumnModel.superclass.constructor.call(this, config);\n\t},\n\n\t/**\n\t * Create an array of {@link Ext.grid.Column columns} which must be visible within\n\t * the default view of this {@link Ext.grid.ColumnModel ColumnModel}.\n\t * @param {Zarafa.plugins.files.data.FileTypes} fileType folder or file\n\t * @return {Ext.grid.Column|Array} The array of columns\n\t * @private\n\t */\n\tcreateDefaultColumns: function (fileType) {\n\t\tvar columns = [\n      {\n\t\t\t\theader   : dgettext('plugin_filesbackendSeafile', 'Name'),\n\t\t\t\tdataIndex: 'shareWithDisplayname',\n\t\t\t\tflex     : 1,\n\t\t\t\tsortable : true,\n\t\t\t\ttooltip  : dgettext('plugin_filesbackendSeafile', 'Sort by: Name')\n\t\t\t}, {\n\t\t\t\theader   : dgettext('plugin_filesbackendSeafile', 'Type'),\n\t\t\t\tdataIndex: 'type',\n\t\t\t\tflex\t   : 1,\n\t\t\t\talign\t   : 'center',\n\t\t\t\tsortable : true,\n\t\t\t\trenderer : this.shareTypeRenderer,\n\t\t\t\ttooltip  : dgettext('plugin_filesbackendSeafile', 'Sort by: Type')\n\t\t\t}, {\n\t\t\t\theader   : dgettext('plugin_filesbackendSeafile', 'Share'),\n\t\t\t\tdataIndex: 'permissionShare',\n\t\t\t\tflex\t   : 1,\n\t\t\t\talign\t   : 'center',\n\t\t\t\tsortable : false,\n\t\t\t\trenderer : this.yesNoRenderer\n\t\t\t}, {\n\t\t\t\theader   : dgettext('plugin_filesbackendSeafile', 'Change'),\n\t\t\t\tdataIndex: 'permissionChange',\n\t\t\t\tflex \t   : 1,\n\t\t\t\talign    : 'center',\n\t\t\t\tsortable : false,\n\t\t\t\trenderer : this.yesNoRenderer\n\t\t\t}];\n\t\t\tif (fileType === Zarafa.plugins.files.data.FileTypes.FOLDER) {\n\t\t\t\tcolumns.push(\n\t\t\t\t{\n\t\t\t\t\theader   : dgettext('plugin_filesbackendSeafile', 'Create'),\n\t\t\t\t\tdataIndex: 'permissionCreate',\n\t\t\t\t\tflex     : 1,\n\t\t\t\t\talign    : 'center',\n\t\t\t\t\tsortable : false,\n\t\t\t\t\trenderer : this.yesNoRenderer\n\t\t\t\t}, {\n\t\t\t\t\theader   : dgettext('plugin_filesbackendSeafile', 'Delete'),\n\t\t\t\t\tdataIndex: 'permissionDelete',\n\t\t\t\t\tflex     : 1,\n\t\t\t\t\talign    : 'center',\n\t\t\t\t\tsortable : false,\n\t\t\t\t\trenderer : this.yesNoRenderer\n\t\t\t\t});\n\t\t\t}\n\t\treturn columns;\n\t},\n\n\t/**\n\t * This renderer will render the type column. It will set the css class either to group or user.\n\t *\n\t * @param value\n\t * @param p\n\t * @param record\n\t * @return {string}\n\t */\n\tshareTypeRenderer: function (value, p, record) {\n\n\t\tp.css = \"shareicon_16_\" + value;\n\n\t\t// add extra css class for empty cell\n\t\tp.css += ' zarafa-grid-empty-cell';\n\n\t\treturn '';\n\t},\n\n\t/**\n\t * This renderer will render the boolean columns.\n\t * It will show nice icons for true and false.\n\t *\n\t * @param value\n\t * @param p\n\t * @param record\n\t * @return {string}\n\t */\n\tyesNoRenderer: function (value, p, record) {\n\n\t\tif (value) {\n\t\t\tp.css = \"shareicon_16_yes\";\n\t\t} else {\n\t\t\tp.css = \"shareicon_16_no\";\n\t\t}\n\n\t\t// add extra css class for empty cell\n\t\tp.css += ' zarafa-grid-empty-cell';\n\n\t\treturn '';\n\t}\n});\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.ui');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.ui.UserGroupPredictorField\n * @extends Ext.form.ComboBox\n * @xtype filesplugin.seafile.usergrouppredictorfield\n *\n * This ComboBox automatically searches for the correct user/group name.\n */\nZarafa.plugins.files.backend.Seafile.ui.UserGroupPredictorField = Ext.extend(Ext.form.ComboBox, {\n\t/**\n\t * @constructor\n\t * @param config\n\t */\n\tconstructor: function (config) {\n\t\tvar recipientStore = new Ext.data.ArrayStore({\n\t\t\tproxy : new Ext.data.HttpProxy({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: container.getBasePath() + 'index.php'\n\t\t\t}),\n\t\t\tmethod: 'GET',\n\t\t\tbaseParams: {\n\t\t\t\tload: 'custom',\n\t\t\t\tname: 'files_get_recipients',\n\t\t\t\tid: config.recordId\n\t\t\t},\n\t\t\tid: 1,\n\t\t\tfields: [\n\t\t\t\t'display_name',\n\t\t\t\t'shareWith',\n\t\t\t\t'object_type'\n\t\t\t]\n\t\t});\n\t\tconfig = config || {};\n\t\tExt.applyIf(config, {\n\t\t\tstore: recipientStore,\n\t\t\tdisplayField: 'display_name',\n\t\t\ttypeAhead: false,\n\t\t\tforceSelection: true,\n\t\t\ttriggerAction: 'query',\n\t\t\titemId: 'predictor',\n\t\t\tmode: 'remote',\n\t\t\tminChars: 2,\n\t\t\temptyText: dgettext('plugin_filesbackendSeafile', 'Type to search'),\n\t\t\tloadingText: dgettext('plugin_filesbackendSeafile', 'Loading...'),\n\t\t\tlistEmptyText: dgettext('plugin_filesbackendSeafile', 'No results'),\n\t\t\titemSelector: 'div.ugpredic_search_item',\n\t\t\ttpl: new Ext.XTemplate(\n\t\t\t\t'<tpl for=\".\">',\n\t\t\t\t'<div class=\"ugpredic_search_item\">',\n\t\t\t\t'<h3>',\n\t\t\t\t'<tpl if=\"object_type == Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.USER\"><span><div class=\"shareicon_16_user\">&nbsp;</div></span></tpl>',\n\t\t\t\t'<tpl if=\"object_type == Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.GROUP\"><span><div class=\"shareicon_16_group\">&nbsp;</div></span></tpl>',\n\t\t\t\t'{display_name:htmlEncode}',\n\t\t\t\t'</h3>',\n\t\t\t\t'</div>',\n\t\t\t\t'</tpl>',\n\t\t\t\t'</tpl>'\n\t\t\t),\n\t\t\tonSelect: this.onSuggestionSelect,\n\t\t\tlisteners : {\n\t\t\t\tinvalid : this.onInvalid,\n\t\t\t\tscope : this\n\t\t\t}\n\t\t});\n\n\t\tZarafa.plugins.files.backend.Seafile.ui.UserGroupPredictorField.superclass.constructor.call(this, config);\n\t},\n\n\t/**\n\t * OnSelect handler for the userGroupPredictor combo box\n\t * @param record the selected record\n\t */\n\tonSuggestionSelect: function(record) {\n\t\tthis.setRawValue(record.get('display_name'));\n\t\t// also set the group field\n\t\tthis.ownerCt['type'].setValue((record.get('object_type') == Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.USER) ? 'user' : 'group');\n\t\tthis.collapse();\n\t},\n\n\t/**\n\t * Function which is fire after the field has been marked as invalid.\n\t * It will collapse suggestions list if it's open.\n\t */\n\tonInvalid: function ()\n\t{\n\t\tif (this.isExpanded()) {\n\t\t\tthis.store.removeAll();\n\t\t\tthis.collapse();\n\t\t}\n\t}\n});\n\nExt.reg('filesplugin.seafile.usergrouppredictorfield', Zarafa.plugins.files.backend.Seafile.ui.UserGroupPredictorField);\n\nExt.namespace('Zarafa.plugins.files.backend.Seafile.data.singleton');\n\n/**\n * @class Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore\n * @extends Object\n *\n * This singleton provides access to the {@link Zarafa.plugins.files.backend.Seafile.data.ShareGridStore ShareGridStore}.\n * It must be initialized once by calling the init method.\n */\nZarafa.plugins.files.backend.Seafile.data.singleton.ShareStore = Ext.extend(Object, {\n\n\t/**\n\t * @property\n\t * @type Zarafa.plugins.files.data.AccountStore\n\t * @private\n\t */\n\tstore: undefined,\n\n\t/**\n\t * Triggers a call to the backend to load version information.\n\t * @param {Number} fileType folder or file\n\t */\n\tinit: function (fileType) {\n\t\tthis.store = new Zarafa.plugins.files.backend.Seafile.data.ShareGridStore(fileType);\n\t},\n\n\t/**\n\t * Loads userdata to the store.\n\t *\n\t * @param {Object} shareOpts object with the sharing options\n\t * Possible values of shareOpts are:\n\t * - id: the id oof the share\n         * - shareWith: seafile internal user identifier\n         * - shareWithDisplayname: the shareusers displayname\n         * - permissions: bytecode presentation of the chare permissions\n         * - shareType: type of the share, one of Zarafa.plugins.files.backend.Seafile.data.RecipientTypes\n\t */\n\taddUser: function (shareOpts) {\n\t\tvar permissionCreate = false;\n\t\tvar permissionChange = false;\n\t\tvar permissionDelete = false;\n\t\tvar permissionShare = false;\n\n\t\t// parse the permission number\n\t\tif ((shareOpts.permissions - 16) >= 1) {\n\t\t\tpermissionShare = true;\n\t\t\tshareOpts.permissions -= 16;\n\t\t}\n\t\tif ((shareOpts.permissions - 8) >= 1) {\n\t\t\tpermissionDelete = true;\n\t\t\tshareOpts.permissions -= 8;\n\t\t}\n\t\tif ((shareOpts.permissions - 4) >= 1) {\n\t\t\tpermissionCreate = true;\n\t\t\tshareOpts.permissions -= 4;\n\t\t}\n\t\tif ((shareOpts.permissions - 2) >= 1) {\n\t\t\tpermissionChange = true;\n\t\t}\n\n\t\tvar record = [shareOpts.id, shareOpts.shareWith, shareOpts.shareWithDisplayname, \"user\", permissionCreate, permissionChange, permissionDelete, permissionShare];\n\n\t\tthis.store.loadData([record], true);\n\t},\n\n\t/**\n\t * Loads groupdata to the store.\n\t *\n\t * @param {Object} shareOpts object with the sharing options\n\t * Possible values of shareOpts are:\n\t * - id: the id oof the share\n         * - shareWith: seafile internal user identifier\n         * - shareWithDisplayname: the shareusers displayname\n         * - permissions: bytecode presentation of the chare permissions\n         * - shareType: type of the share, one of Zarafa.plugins.files.backend.Seafile.data.RecipientTypes\n\t */\n\taddGroup: function (shareOpts) {\n\t\tvar permissionCreate = false;\n\t\tvar permissionChange = false;\n\t\tvar permissionDelete = false;\n\t\tvar permissionShare = false;\n\n\t\t// parse the permission number\n\t\tif ((shareOpts.permissions - 16) >= 1) {\n\t\t\tpermissionShare = true;\n\t\t\tshareOpts.permissions -= 16;\n\t\t}\n\t\tif ((shareOpts.permissions - 8) >= 1) {\n\t\t\tpermissionDelete = true;\n\t\t\tshareOpts.permissions -= 8;\n\t\t}\n\t\tif ((shareOpts.permissions - 4) >= 1) {\n\t\t\tpermissionCreate = true;\n\t\t\tshareOpts.permissions -= 4;\n\t\t}\n\t\tif ((shareOpts.permissions - 2) >= 1) {\n\t\t\tpermissionChange = true;\n\t\t}\n\n\t\tvar record = [shareOpts.id, shareOpts.shareWith, shareOpts.shareWithDisplayname, \"group\", permissionCreate, permissionChange, permissionDelete, permissionShare];\n\n\t\tthis.store.loadData([record], true);\n\t},\n\n\t/**\n\t * Get instance of the {@link Zarafa.plugins.files.data.AccountStore Accountstore}\n\t * @return {Zarafa.plugins.files.data.AccountStore} the account store\n\t */\n\tgetStore: function () {\n\t\treturn this.store;\n\t}\n});\n\n// Make it a Singleton\nZarafa.plugins.files.backend.Seafile.data.singleton.ShareStore = new Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore();\n"]}