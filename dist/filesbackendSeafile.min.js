Ext.namespace("Zarafa.plugins.files.backend.Seafile"),Zarafa.plugins.files.backend.Seafile.SeafileBackend=Ext.extend(Zarafa.core.Plugin,{constructor:function(e){e=e||{},Zarafa.plugins.files.backend.Seafile.SeafileBackend.superclass.constructor.call(this,e)},initPlugin:function(){Zarafa.plugins.files.backend.Seafile.SeafileBackend.superclass.initPlugin.apply(this,arguments),this.registerInsertionPoint("plugin.files.sharedialog",this.createShareDialogInsertionPoint,this),Zarafa.core.data.SharedComponentType.addProperty("filesplugin.seafile.useredit")},createShareDialogInsertionPoint:function(){return{xtype:"filesplugin.seafile.filessharedialogpanel"}},bidSharedComponent:function(e,t){var i=-1;switch(e){case Zarafa.core.data.SharedComponentType["filesplugin.seafile.useredit"]:i=1}return i},getSharedComponent:function(e,t){var i;switch(e){case Zarafa.core.data.SharedComponentType["filesplugin.seafile.useredit"]:i=Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel}return i}}),Zarafa.onReady(function(){container.registerPlugin(new Zarafa.core.PluginMetaData({name:"filesbackendSeafile",displayName:dgettext("plugin_filesbackendSeafile","Files: Seafile Backend"),allowUserDisable:!1,pluginConstructor:Zarafa.plugins.files.backend.Seafile.SeafileBackend}))}),Ext.namespace("Zarafa.plugins.files.backend.Seafile.data"),Zarafa.plugins.files.backend.Seafile.data.RecipientTypes=Zarafa.core.Enum.create({USER:0,GROUP:1,LINK:3}),Ext.namespace("Zarafa.plugins.files.backend.Seafile.data"),Zarafa.plugins.files.backend.Seafile.data.ResponseHandler=Ext.extend(Zarafa.core.data.AbstractResponseHandler,{successCallback:null,failureCallback:null,doLoadsharingdetails:function(e){this.successCallback(e)},doCreatenewshare:function(e){this.successCallback(e)},doDeleteexistingshare:function(e){this.successCallback(e)},doUpdateexistingshare:function(e){this.successCallback(e)},doError:function(e){Zarafa.common.dialogs.MessageBox.show({title:e.header,msg:e.message,icon:Zarafa.common.dialogs.MessageBox.ERROR,buttons:Zarafa.common.dialogs.MessageBox.OK}),this.failureCallback(e)}}),Ext.reg("filesplugin.seafile.responsehandler",Zarafa.plugins.files.backend.Seafile.data.ResponseHandler),Ext.namespace("Zarafa.plugins.files.backend.Seafile.data"),Zarafa.plugins.files.backend.Seafile.data.ShareGridRecord=Ext.data.Record.create({name:"id",type:"string"},{name:"shareWith",type:"string"},{name:"shareWithDisplayname",type:"string"},{name:"type",type:"string"},{name:"permissionCreate",type:"bool"},{name:"permissionChange",type:"bool"},{name:"permissionDelete",type:"bool"},{name:"permissionShare",type:"bool"}),Ext.namespace("Zarafa.plugins.files.backend.Seafile.data"),Zarafa.plugins.files.backend.Seafile.data.ShareGridStore=Ext.extend(Ext.data.ArrayStore,{constructor:function(e){Zarafa.plugins.files.backend.Seafile.data.ShareGridStore.superclass.constructor.call(this,{fields:["id","shareWith","shareWithDisplayname","type","permissionCreate","permissionChange","permissionDelete","permissionShare"],fileType:e})}}),Ext.reg("filesplugin.seafile.sharegridstore",Zarafa.plugins.files.backend.Seafile.data.ShareGridStore),Ext.namespace("Ext.ux"),Ext.ux.CopyButton=Ext.extend(Ext.Button,{zclipboard:void 0,completeText:"Text copied to clipboard",swfPath:"ZeroClipboard.swf",constructor:function(e){e=e||{},Ext.ux.CopyButton.superclass.constructor.call(this,e),this.init()},init:function(){ZeroClipboard.config({moviePath:this.swfPath}),this.zclipboard=new ZeroClipboard},afterRender:function(){Ext.ux.CopyButton.superclass.afterRender.call(this),this.zclipboard.clip(this.getEl().dom),this.zclipboard.on("complete",this.onCopyComplete.createDelegate(this)),this.zclipboard.on("dataRequested",this.onDataRequested.createDelegate(this))},onDestroy:function(){this.zclipboard.destroy(),Ext.ux.CopyButton.superclass.onDestroy.call(this)},onDataRequested:function(e,t){e.setText(this.getValue())},onCopyComplete:function(e,t){alert(this.completeText)},setValue:function(e){this.value=String(e)},getValue:function(){return this.value}}),Ext.reg("copybutton",Ext.ux.CopyButton),function(e){"use strict";var t,i,a,s,r,n={bridge:null,version:"0.0.0",disabled:null,outdated:null,ready:null},o={},l=0,d={},c=0,f={},p=null,u=null,h=function(){var e,t,i,a,s="ZeroClipboard.swf";if(document.currentScript&&(a=document.currentScript.src));else{var r=document.getElementsByTagName("script");if("readyState"in r[0])for(e=r.length;e--&&("interactive"!==r[e].readyState||!(a=r[e].src)););else if("loading"===document.readyState)a=r[r.length-1].src;else{for(e=r.length;e--;){if(!(i=r[e].src)){t=null;break}if(i=(i=i.split("#")[0].split("?")[0]).slice(0,i.lastIndexOf("/")+1),null==t)t=i;else if(t!==i){t=null;break}}null!==t&&(a=t)}}return a&&(s=(a=a.split("#")[0].split("?")[0]).slice(0,a.lastIndexOf("/")+1)+s),s}(),g=(i=/\-([a-z])/g,a=function(e,t){return t.toUpperCase()},function(e){return e.replace(i,a)}),b=function(t){var i;t||(t=e.event),this!==e?i=this:t.target?i=t.target:t.srcElement&&(i=t.srcElement),P.activate(i)},m=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&"string"==typeof t){var i=(t||"").split(/\s+/);if(1===e.nodeType)if(e.className){for(var a=" "+e.className+" ",s=e.className,r=0,n=i.length;r<n;r++)a.indexOf(" "+i[r]+" ")<0&&(s+=" "+i[r]);e.className=s.replace(/^\s+|\s+$/g,"")}else e.className=t}return e},y=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if(t&&"string"==typeof t||void 0===t){var i=(t||"").split(/\s+/);if(1===e.nodeType&&e.className)if(t){for(var a=(" "+e.className+" ").replace(/[\n\t]/g," "),s=0,r=i.length;s<r;s++)a=a.replace(" "+i[s]+" "," ");e.className=a.replace(/^\s+|\s+$/g,"")}else e.className=""}return e},x=function(t,i){var a={left:0,top:0,width:0,height:0,zIndex:C(i)-1};if(t.getBoundingClientRect){var s,r,n,o=t.getBoundingClientRect();"pageXOffset"in e&&"pageYOffset"in e?(s=e.pageXOffset,r=e.pageYOffset):(n=function(){var e,t,i,a=1;return"function"==typeof document.body.getBoundingClientRect&&(t=(e=document.body.getBoundingClientRect()).right-e.left,i=document.body.offsetWidth,a=Math.round(t/i*100)/100),a}(),s=Math.round(document.documentElement.scrollLeft/n),r=Math.round(document.documentElement.scrollTop/n));var l=document.documentElement.clientLeft||0,d=document.documentElement.clientTop||0;a.left=o.left+s-l,a.top=o.top+r-d,a.width="width"in o?o.width:o.right-o.left,a.height="height"in o?o.height:o.bottom-o.top}return a},S=function(e,t,i){if("function"==typeof t.indexOf)return t.indexOf(e,i);var a,s=t.length;for(void 0===i?i=0:i<0&&(i=s+i),a=i;a<s;a++)if(t.hasOwnProperty(a)&&t[a]===e)return a;return-1},v=function(e){if("string"==typeof e)throw new TypeError("ZeroClipboard doesn't accept query strings.");return e.length?e:[e]},k=function(t,i,a,s){s?e.setTimeout(function(){t.apply(i,a)},0):t.apply(i,a)},C=function(e){var t,i;return e&&("number"==typeof e&&e>0?t=e:"string"==typeof e&&(i=parseInt(e,10))&&!isNaN(i)&&i>0&&(t=i)),t||("number"==typeof O.zIndex&&O.zIndex>0?t=O.zIndex:"string"==typeof O.zIndex&&(i=parseInt(O.zIndex,10))&&!isNaN(i)&&i>0&&(t=i)),t||0},w=function(e,t){if(e&&!1!==t&&"undefined"!=typeof console&&console&&(console.warn||console.log)){var i="`"+e+"` is deprecated. See docs for more info:\n    https://github.com/zeroclipboard/zeroclipboard/blob/master/docs/instructions.md#deprecations";console.warn?console.warn(i):console.log(i)}},E=function(){var e,t,i,a,s,r=arguments[0]||{};for(e=1,t=arguments.length;e<t;e++)if(null!=(i=arguments[e]))for(a in i)if(i.hasOwnProperty(a)){if(r[a],r===(s=i[a]))continue;void 0!==s&&(r[a]=s)}return r},D=function(e){if(null==e||""===e)return null;if(""===(e=e.replace(/^\s+|\s+$/g,"")))return null;var t=e.indexOf("//"),i=(e=-1===t?e:e.slice(t+2)).indexOf("/");return(e=-1===i?e:-1===t||0===i?null:e.slice(0,i))&&".swf"===e.slice(-4).toLowerCase()?null:e||null},Z=(s=function(e,t){var i,a,s;if(null!=e&&"*"!==t[0]&&("string"==typeof e&&(e=[e]),"object"==typeof e&&"length"in e))for(i=0,a=e.length;i<a;i++)if(e.hasOwnProperty(i)&&(s=D(e[i]))){if("*"===s){t.length=0,t.push("*");break}-1===S(s,t)&&t.push(s)}},r={always:"always",samedomain:"sameDomain",never:"never"},function(e,t){var i,a=t.allowScriptAccess;if("string"==typeof a&&(i=a.toLowerCase())&&/^always|samedomain|never$/.test(i))return r[i];var n=D(t.moviePath);null===n&&(n=e);var o=[];s(t.trustedOrigins,o),s(t.trustedDomains,o);var l=o.length;if(l>0){if(1===l&&"*"===o[0])return"always";if(-1!==S(e,o))return 1===l&&e===n?"sameDomain":"always"}return"never"}),R=function(e){if(null==e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t},I=function(){var e=!1;if("boolean"==typeof n.disabled)e=!1===n.disabled;else{if("function"==typeof ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(e=!0)}catch(e){}!e&&navigator.mimeTypes["application/x-shockwave-flash"]&&(e=!0)}return e};function T(e){return e.replace(/,/g,".").replace(/[^0-9\.]/g,"")}function L(e){return parseFloat(T(e))>=10}var P=function(e,t){if(!(this instanceof P))return new P(e,t);this.id=""+l++,d[this.id]={instance:this,elements:[],handlers:{}},e&&this.clip(e),void 0!==t&&(w("new ZeroClipboard(elements, options)",O.debug),P.config(t)),this.options=P.config(),"boolean"!=typeof n.disabled&&(n.disabled=!I()),!1===n.disabled&&!0!==n.outdated&&null===n.bridge&&(n.outdated=!1,n.ready=!1,F())};P.prototype.setText=function(e){return e&&""!==e&&(o["text/plain"]=e,!0===n.ready&&n.bridge&&"function"==typeof n.bridge.setText?n.bridge.setText(e):n.ready=!1),this},P.prototype.setSize=function(e,t){return!0===n.ready&&n.bridge&&"function"==typeof n.bridge.setSize?n.bridge.setSize(e,t):n.ready=!1,this};var _=function(e){!0===n.ready&&n.bridge&&"function"==typeof n.bridge.setHandCursor?n.bridge.setHandCursor(e):n.ready=!1};P.prototype.destroy=function(){this.unclip(),this.off(),delete d[this.id]};P.version="1.3.5";var O={swfPath:h,trustedDomains:e.location.host?[e.location.host]:[],cacheBust:!0,forceHandCursor:!1,zIndex:999999999,debug:!0,title:null,autoActivate:!0};P.config=function(e){if("object"==typeof e&&null!==e&&E(O,e),"string"==typeof e&&e)return O.hasOwnProperty(e)?O[e]:void 0;var t={};for(var i in O)O.hasOwnProperty(i)&&("object"==typeof O[i]&&null!==O[i]?"length"in O[i]?t[i]=O[i].slice(0):t[i]=E({},O[i]):t[i]=O[i]);return t},P.destroy=function(){for(var e in P.deactivate(),d)if(d.hasOwnProperty(e)&&d[e]){var t=d[e].instance;t&&"function"==typeof t.destroy&&t.destroy()}var i=B(n.bridge);i&&i.parentNode&&(i.parentNode.removeChild(i),n.ready=null,n.bridge=null)},P.activate=function(i){t&&(y(t,O.hoverClass),y(t,O.activeClass)),t=i,m(i,O.hoverClass),M();var a=O.title||i.getAttribute("title");if(a){var s=B(n.bridge);s&&s.setAttribute("title",a)}var r,o,l,d,c=!0===O.forceHandCursor||"pointer"===(r=i,o="cursor",e.getComputedStyle?l=e.getComputedStyle(r,null).getPropertyValue(o):(d=g(o),l=r.currentStyle?r.currentStyle[d]:r.style[d]),"cursor"!==o||l&&"auto"!==l||"a"!==r.tagName.toLowerCase()?l:"pointer");_(c)},P.deactivate=function(){var e=B(n.bridge);e&&(e.style.left="0px",e.style.top="-9999px",e.removeAttribute("title")),t&&(y(t,O.hoverClass),y(t,O.activeClass),t=null)};var F=function(){var t,i,a,s,r=document.getElementById("global-zeroclipboard-html-bridge");if(!r){var o=P.config();o.jsModuleId="string"==typeof p&&p||"string"==typeof u&&u||null;var l=Z(e.location.host,O),d=function(t){var i,a,s,r=[],n=[],o=[];if(t.trustedOrigins&&("string"==typeof t.trustedOrigins?n.push(t.trustedOrigins):"object"==typeof t.trustedOrigins&&"length"in t.trustedOrigins&&(n=n.concat(t.trustedOrigins))),t.trustedDomains&&("string"==typeof t.trustedDomains?n.push(t.trustedDomains):"object"==typeof t.trustedDomains&&"length"in t.trustedDomains&&(n=n.concat(t.trustedDomains))),n.length)for(i=0,a=n.length;i<a;i++)if(n.hasOwnProperty(i)&&n[i]&&"string"==typeof n[i]){if(!(s=D(n[i])))continue;if("*"===s){o=[s];break}o.push.apply(o,[s,"//"+s,e.location.protocol+"//"+s])}return o.length&&r.push("trustedOrigins="+encodeURIComponent(o.join(","))),"string"==typeof t.jsModuleId&&t.jsModuleId&&r.push("jsModuleId="+encodeURIComponent(t.jsModuleId)),r.join("&")}(o),c=O.moviePath+(a=O.moviePath,null==(s=O)||s&&!0===s.cacheBust&&!0===s.useNoCache?(-1===a.indexOf("?")?"?":"&")+"noCache="+(new Date).getTime():""),f='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+c+'"/>         <param name="allowScriptAccess" value="'+l+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+d+'"/>         <embed src="'+c+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="'+l+'"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+d+'"           scale="exactfit">         </embed>       </object>';(r=document.createElement("div")).id="global-zeroclipboard-html-bridge",r.setAttribute("class","global-zeroclipboard-container"),r.style.position="absolute",r.style.left="0px",r.style.top="-9999px",r.style.width="15px",r.style.height="15px",r.style.zIndex=""+C(O.zIndex),document.body.appendChild(r),r.innerHTML=f}(t=document["global-zeroclipboard-flash-bridge"])&&(i=t.length)&&(t=t[i-1]),n.bridge=t||r.children[0].lastElementChild},B=function(e){for(var t=/^OBJECT|EMBED$/,i=e&&e.parentNode;i&&t.test(i.nodeName)&&i.parentNode;)i=i.parentNode;return i||null},M=function(){if(t){var e=x(t,O.zIndex),i=B(n.bridge);i&&(i.style.top=e.top+"px",i.style.left=e.left+"px",i.style.width=e.width+"px",i.style.height=e.height+"px",i.style.zIndex=e.zIndex+1),!0===n.ready&&n.bridge&&"function"==typeof n.bridge.setSize?n.bridge.setSize(e.width,e.height):n.ready=!1}return this};P.prototype.on=function(e,t){var i,a,s,r={},o=d[this.id]&&d[this.id].handlers;if("string"==typeof e&&e)s=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&void 0===t)for(i in e)e.hasOwnProperty(i)&&"string"==typeof i&&i&&"function"==typeof e[i]&&this.on(i,e[i]);if(s&&s.length){for(i=0,a=s.length;i<a;i++)r[e=s[i].replace(/^on/,"")]=!0,o[e]||(o[e]=[]),o[e].push(t);r.noflash&&n.disabled&&V.call(this,"noflash",{}),r.wrongflash&&n.outdated&&V.call(this,"wrongflash",{flashVersion:n.version}),r.load&&n.ready&&V.call(this,"load",{flashVersion:n.version})}return this},P.prototype.off=function(e,t){var i,a,s,r,n,o=d[this.id]&&d[this.id].handlers;if(0===arguments.length)r=R(o);else if("string"==typeof e&&e)r=e.split(/\s+/);else if("object"==typeof e&&e&&void 0===t)for(i in e)e.hasOwnProperty(i)&&"string"==typeof i&&i&&"function"==typeof e[i]&&this.off(i,e[i]);if(r&&r.length)for(i=0,a=r.length;i<a;i++)if((n=o[e=r[i].toLowerCase().replace(/^on/,"")])&&n.length)if(t)for(s=S(t,n);-1!==s;)n.splice(s,1),s=S(t,n,s);else o[e].length=0;return this},P.prototype.handlers=function(e){var t,i=null,a=d[this.id]&&d[this.id].handlers;if(a){if("string"==typeof e&&e)return a[e]?a[e].slice(0):null;for(t in i={},a)a.hasOwnProperty(t)&&a[t]&&(i[t]=a[t].slice(0))}return i};P.prototype.clip=function(e){e=v(e);for(var t=0;t<e.length;t++)if(e.hasOwnProperty(t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===S(this.id,f[e[t].zcClippingId])&&f[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+c++,f[e[t].zcClippingId]=[this.id],!0===O.autoActivate&&(a=e[t],s="mouseover",r=b,a&&1===a.nodeType&&(a.addEventListener?a.addEventListener(s,r,!1):a.attachEvent&&a.attachEvent("on"+s,r))));var i=d[this.id].elements;-1===S(e[t],i)&&i.push(e[t])}var a,s,r;return this},P.prototype.unclip=function(e){var t,i,a,s=d[this.id];if(s)for(var r,n=s.elements,o=(e=void 0===e?n.slice(0):v(e)).length;o--;)if(e.hasOwnProperty(o)&&e[o]&&1===e[o].nodeType){for(r=0;-1!==(r=S(e[o],n,r));)n.splice(r,1);var l=f[e[o].zcClippingId];if(l){for(r=0;-1!==(r=S(this.id,l,r));)l.splice(r,1);0===l.length&&(!0===O.autoActivate&&(t=e[o],i="mouseover",a=b,t&&1===t.nodeType&&(t.removeEventListener?t.removeEventListener(i,a,!1):t.detachEvent&&t.detachEvent("on"+i,a))),delete e[o].zcClippingId)}}return this},P.prototype.elements=function(){var e=d[this.id];return e&&e.elements?e.elements.slice(0):[]};O.hoverClass="zeroclipboard-is-hover",O.activeClass="zeroclipboard-is-active",O.trustedOrigins=null,O.allowScriptAccess=null,O.useNoCache=!0,O.moviePath="ZeroClipboard.swf",P.detectFlashSupport=function(){return w("ZeroClipboard.detectFlashSupport",O.debug),I()},P.dispatch=function(e,i){if("string"==typeof e&&e){var a=e.toLowerCase().replace(/^on/,"");if(a)for(var s=t&&!0===O.autoActivate?function(e){var t,i,a,s,r,n=[];if(e&&1===e.nodeType&&(t=e.zcClippingId)&&f.hasOwnProperty(t)&&(i=f[t])&&i.length)for(a=0,s=i.length;a<s;a++)(r=d[i[a]].instance)&&r instanceof P&&n.push(r);return n}(t):function(){var e,t,i,a=[],s=R(d);for(e=0,t=s.length;e<t;e++)(i=d[s[e]].instance)&&i instanceof P&&a.push(i);return a}(),r=0,n=s.length;r<n;r++)V.call(s[r],a,i)}},P.prototype.setHandCursor=function(e){return w("ZeroClipboard.prototype.setHandCursor",O.debug),_(e="boolean"==typeof e?e:!!e),O.forceHandCursor=e,this},P.prototype.reposition=function(){return w("ZeroClipboard.prototype.reposition",O.debug),M()},P.prototype.receiveEvent=function(e,t){if(w("ZeroClipboard.prototype.receiveEvent",O.debug),"string"==typeof e&&e){var i=e.toLowerCase().replace(/^on/,"");i&&V.call(this,i,t)}},P.prototype.setCurrent=function(e){return w("ZeroClipboard.prototype.setCurrent",O.debug),P.activate(e),this},P.prototype.resetBridge=function(){return w("ZeroClipboard.prototype.resetBridge",O.debug),P.deactivate(),this},P.prototype.setTitle=function(e){if(w("ZeroClipboard.prototype.setTitle",O.debug),e=e||O.title||t&&t.getAttribute("title")){var i=B(n.bridge);i&&i.setAttribute("title",e)}return this},P.setDefaults=function(e){w("ZeroClipboard.setDefaults",O.debug),P.config(e)},P.prototype.addEventListener=function(e,t){return w("ZeroClipboard.prototype.addEventListener",O.debug),this.on(e,t)},P.prototype.removeEventListener=function(e,t){return w("ZeroClipboard.prototype.removeEventListener",O.debug),this.off(e,t)},P.prototype.ready=function(){return w("ZeroClipboard.prototype.ready",O.debug),!0===n.ready};var V=function(i,a){i=i.toLowerCase().replace(/^on/,"");var s=a&&a.flashVersion&&T(a.flashVersion)||null,r=t,l=!0;switch(i){case"load":if(s){if(!L(s))return void V.call(this,"onWrongFlash",{flashVersion:s});n.outdated=!1,n.ready=!0,n.version=s}break;case"wrongflash":s&&!L(s)&&(n.outdated=!0,n.ready=!1,n.version=s);break;case"mouseover":m(r,O.hoverClass);break;case"mouseout":!0===O.autoActivate&&P.deactivate();break;case"mousedown":m(r,O.activeClass);break;case"mouseup":y(r,O.activeClass);break;case"datarequested":if(r){var c=r.getAttribute("data-clipboard-target"),f=c?document.getElementById(c):null;if(f){var p=f.value||f.textContent||f.innerText;p&&this.setText(p)}else{var u=r.getAttribute("data-clipboard-text");u&&this.setText(u)}}l=!1;break;case"complete":!function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&delete e[t]}(o),r&&r!==function(){try{return document.activeElement}catch(e){}return null}()&&r.focus&&r.focus()}return function(t,i,a,s){var r=d[this.id]&&d[this.id].handlers[t];if(r&&r.length){var n,o,l,c=i||this;for(n=0,o=r.length;n<o;n++)i=c,"string"==typeof(l=r[n])&&"function"==typeof e[l]&&(l=e[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(i=l,l=l.handleEvent),"function"==typeof l&&k(l,i,a,s)}return this}.call(this,i,r,[this,a],l)};"function"==typeof define&&define.amd?define(["require","exports","module"],function(e,t,i){return p=i&&i.id||null,P}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports&&"function"==typeof e.require?(u=module.id||null,module.exports=P):e.ZeroClipboard=P}(function(){return this}()),Ext.namespace("Zarafa.plugins.files.backend.Seafile.ui"),Zarafa.plugins.files.backend.Seafile.ui.FilesShareDialogPanel=Ext.extend(Zarafa.plugins.files.ui.dialogs.SharePanel,{loadMask:void 0,passwordChanged:!1,expirationDateChanged:!1,pubUploadChanged:!1,linkShareID:-1,recordId:void 0,parentRecord:void 0,constructor:function(e){var t=(e=e||{}).ownerCt.records[0].get("type");this.recordId=e.ownerCt.records[0].get("id"),this.parentRecord=e.ownerCt.records[0],Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.init(t),this.setupGridStoreListeners(),Ext.applyIf(e,{listeners:{afterrender:this.checkSharedRecord},height:450,width:780,items:[{xtype:"fieldset",title:dgettext("plugin_filesbackendSeafile","Share with user/group"),autoHeight:!0,ref:"userfieldset",items:[{xtype:"filesplugin.seafile.filesshareusergrid",ref:"../usergrid",height:200,recordId:this.recordId}]},{xtype:"checkbox",fieldLabel:"",boxLabel:dgettext("plugin_filesbackendSeafile","Share via link"),ref:"linkcheckbox",inputValue:"sharelink",style:{marginTop:"5px",marginLeft:"6px"},listeners:{check:this.onShareViaLinkChecked.createDelegate(this)}},{xtype:"fieldset",title:dgettext("plugin_filesbackendSeafile","Share via link"),autoHeight:!0,ref:"linkfieldset",hidden:!0,items:[{layout:"column",border:!1,defaults:{border:!1},anchor:"0",items:[{columnWidth:.95,layout:"form",items:{xtype:"textfield",fieldLabel:dgettext("plugin_filesbackendSeafile","Public link"),ref:"../../../linkfield",anchor:"100%",selectOnFocus:!0,readOnly:!0}},{columnWidth:.05,items:{xtype:"copybutton",swfPath:"plugins/filesbackendSeafile/resources/flash/ZeroClipboard.swf",completeText:dgettext("plugin_filesbackendSeafile","Link copied to clipboard"),iconCls:"icon_copy_clipboard",getValue:this.getPublicLinkValue.createDelegate(this)}}]},{xtype:"checkbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Password protect"),boxLabel:"",ref:"../passwordcheckbox",inputValue:"pwprotected",listeners:{check:this.onUsePasswordChecked.createDelegate(this)}},{xtype:"textfield",fieldLabel:dgettext("plugin_filesbackendSeafile","Password"),ref:"../passwordfield",hidden:!0,inputType:"password",name:"textvalue",listeners:{change:this.onPasswordChange.createDelegate(this),keyup:this.onPasswordChange.createDelegate(this)}},{xtype:"checkbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Public upload"),boxLabel:"",hidden:!0,ref:"../editcheckbox",inputValue:"allowediting",listeners:{check:this.onAllowEditingChecked.createDelegate(this)}},{xtype:"checkbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Expiration date"),boxLabel:"",ref:"../expirationcheckbox",inputValue:"useexpiration",listeners:{check:this.onUseExpirationDateChecked.createDelegate(this)}},{xtype:"datefield",ref:"../expirationfield",hidden:!0,fieldLabel:dgettext("plugin_filesbackendSeafile","Date"),minValue:new Date((new Date).getTime()+864e5),width:170,format:"Y-m-d",listeners:{change:this.onExpirationDateChange.createDelegate(this),keyup:this.onExpirationDateChange.createDelegate(this)}}]}],buttons:[{xtype:"button",text:dgettext("plugin_filesbackendSeafile","Ok"),handler:this.onDoneButtonClick,ref:"../doneButton",scope:this},{xtype:"button",text:dgettext("plugin_filesbackendSeafile","Cancel"),handler:this.onCancel,scope:this}]}),Zarafa.plugins.files.backend.Seafile.ui.FilesShareDialogPanel.superclass.constructor.call(this,e)},setupGridStoreListeners:function(){var e=Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.getStore();e.on("add",this.onGridStoreAdd,this),e.on("update",this.onGridStoreUpdate,this),e.on("remove",this.onGridStoreRemove,this)},onGridStoreRemove:function(e,t){""!=t.get("id")&&-1!=t.get("id")&&this.removeShareByID(t.get("id"))},onGridStoreUpdate:function(e,t){this.updateExistingShare(t)},onGridStoreAdd:function(e,t){if(1!=t.length||-1!=t[0].get("id"))return!0;this.createShare(t[0],e,!1)},onShareViaLinkChecked:function(e,t){t?(this.linkfieldset.show(),this.createShareByLink()):(this.linkfieldset.hide(),this.removeShareByID(this.linkShareID),this.linkShareID=-1)},onUsePasswordChecked:function(e,t){t?this.passwordfield.show():this.passwordfield.hide()},onPasswordChange:function(e,t){this.passwordChanged=!0},onAllowEditingChecked:function(e,t){this.pubUploadChanged=!0},onUseExpirationDateChecked:function(e,t){t?this.expirationfield.show():this.expirationfield.hide()},onExpirationDateChange:function(){this.expirationDateChanged=!0},onCancel:function(){this.dialog.close()},getPublicLinkValue:function(){return this.linkfield.getValue()},closeDialog:function(){var e=Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.getStore();e.un("update",this.onGridStoreUpdate,this),e.un("remove",this.onGridStoreRemove,this),this.dialog.close()},closeLoadMask:function(){this.loadMask.hide()},onDoneButtonClick:function(){this.linkcheckbox.getValue()?this.updateExistingShare():this.closeDialog()},checkSharedRecord:function(){this.loadMask=new Ext.LoadMask(this.getEl(),{msg:dgettext("plugin_filesbackendSeafile","Loading details...")}),Ext.isDefined(this.parentRecord)&&(this.parentRecord.get("type")===Zarafa.plugins.files.data.FileTypes.FOLDER&&this.editcheckbox.show(),!0===this.parentRecord.get("isshared")&&this.initSharedRecord())},initSharedRecord:function(){this.loadMask.show();var e=[this.recordId];container.getRequest().singleRequest("filesbrowsermodule","loadsharingdetails",{records:e},new Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({successCallback:this.initGuiFromSharedRecord.createDelegate(this)}))},initGuiFromSharedRecord:function(e){var t=e.shares[this.recordId];for(var i in t){var a=t[i];if(a.shareType===Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.LINK){if(this.linkShareID=i,this.linkfieldset.show(),this.linkcheckbox.suspendEvents(!1),this.linkcheckbox.setValue(!0),this.linkcheckbox.resumeEvents(),this.linkfield.setValue(a.url),!Ext.isEmpty(a.expiration)){this.expirationcheckbox.setValue(!0);var s=new Date(a.expiration);this.expirationfield.setValue(s)}Ext.isEmpty(a.shareWith)||(this.passwordcheckbox.setValue(!0),this.passwordfield.setValue("******")),Ext.isEmpty(a.permissions)||7===parseInt(a.permissions,10)&&(this.editcheckbox.suspendEvents(!1),this.editcheckbox.setValue(!0),this.editcheckbox.resumeEvents())}else a.shareType===Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.GROUP?Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.addGroup(a):Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.addUser(a);this.doneButton.setDisabled(!1)}this.loadMask.hide()},createShareByLink:function(){this.loadMask.show();var e=[this.recordId],t={shareType:Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.LINK};container.getRequest().singleRequest("filesbrowsermodule","createnewshare",{records:e,options:t},new Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({successCallback:this.shareByLinkCreated.createDelegate(this),failureCallback:this.closeDialog.createDelegate(this)}))},shareByLinkCreated:function(e){var t=e.shares[this.recordId.replace(/\/+$/g,"")];this.linkfield.setValue(t.url),this.linkShareID=t.id;var i=this.parentRecord.get("sharedid")||[];i.push(t.id),this.parentRecord.set("sharedid",i),this.parentRecord.set("isshared",!0),this.doneButton.setDisabled(!1),this.loadMask.hide()},removeShareByID:function(e){this.loadMask.show();var t=this.parentRecord.getAccount().get("id");container.getRequest().singleRequest("filesbrowsermodule","deleteexistingshare",{records:[e],accountid:t},new Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({successCallback:this.shareByIDRemoved.createDelegate(this,[e],!0),failureCallback:this.closeDialog.createDelegate(this)}))},shareByIDRemoved:function(e,t){var i=this.parentRecord.get("sharedid")||[],a=i.indexOf(t);a>-1&&i.splice(a,1),this.parentRecord.set("sharedid",i),0==i.length&&this.parentRecord.set("isshared",!1),this.loadMask.hide()},createShare:function(e,t){this.loadMask.show();var i=[this.recordId],a=this.getPermissions(e),s={shareType:"user"===e.get("type")?Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.USER:Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.GROUP,shareWith:e.get("shareWith"),permissions:a,shareWithDisplayname:e.get("shareWithDisplayname")};container.getRequest().singleRequest("filesbrowsermodule","createnewshare",{records:i,options:s},new Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({successCallback:this.shareCreated.createDelegate(this,[s,e],!0),failureCallback:this.shareFailed.createDelegate(this,[t,e])}))},shareCreated:function(e,t,i){var a=e.shares[this.recordId.replace(/\/+$/g,"")],s=this.parentRecord.get("sharedid")||[];s.push(a.id),i.data.id=a.id,this.parentRecord.set("sharedid",s),this.parentRecord.set("isshared",!0),t.id=a.id,this.loadMask.hide()},shareFailed:function(e,t){e.remove(t),this.loadMask.hide()},updateExistingShare:function(e){this.loadMask.show();var t={},i=[];Ext.isDefined(e)?(t.permissions=this.getPermissions(e),i.push(e.get("id"))):(this.passwordChanged&&(t.password=this.passwordfield.getValue()),this.passwordcheckbox.getValue()||(t.password=""),this.pubUploadChanged&&(this.editcheckbox.getValue()?t.permissions=7:t.permissions=1),this.expirationDateChanged&&(t.expireDate=this.expirationfield.getRawValue()),this.expirationcheckbox.getValue()||(t.expireDate=""),i.push(this.linkShareID)),container.getRequest().singleRequest("filesbrowsermodule","updateexistingshare",{records:i,accountid:this.parentRecord.getAccount().get("id"),options:t},new Zarafa.plugins.files.backend.Seafile.data.ResponseHandler({successCallback:this.shareByLinkUpdated.createDelegate(this,[e]),failureCallback:this.closeLoadMask.createDelegate(this)}))},shareByLinkUpdated:function(e){this.loadMask.hide(),Ext.isDefined(e)||this.closeDialog()},getPermissions:function(e){var t=1;return e.get("permissionChange")&&(t+=2),e.get("permissionCreate")&&(t+=4),e.get("permissionDelete")&&(t+=8),e.get("permissionShare")&&(t+=16),t}}),Ext.reg("filesplugin.seafile.filessharedialogpanel",Zarafa.plugins.files.backend.Seafile.ui.FilesShareDialogPanel),Ext.namespace("Zarafa.plugins.files.backend.Seafile.ui"),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel=Ext.extend(Zarafa.core.ui.ContentPanel,{loadMask:void 0,constructor:function(e){Ext.applyIf(e,{layout:"fit",title:dgettext("plugin_filesbackendSeafile","Share Details"),closeOnSave:!0,model:!0,autoSave:!1,width:480,height:445,items:{xtype:"filesplugin.seafile.filesshareusereditpanel",record:e.record,store:e.store,recordId:e.recordId}}),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel.superclass.constructor.call(this,e)}}),Ext.reg("filesplugin.seafile.filesshareusereditcontentpanel",Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditContentPanel),Ext.namespace("Zarafa.plugins.files.backend.Seafile.ui"),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel=Ext.extend(Ext.form.FormPanel,{record:void 0,store:void 0,recordId:void 0,constructor:function(e){e.record&&(this.record=e.record),e.store&&(this.store=e.store),e.recordId&&(this.recordId=e.recordId),Ext.applyIf(e||{},{labelAlign:"left",defaultType:"textfield",items:this.createPanelItems(),buttons:[{text:dgettext("plugin_filesbackendSeafile","Save"),handler:this.doSave,scope:this},{text:dgettext("plugin_filesbackendSeafile","Cancel"),handler:this.doClose,scope:this}]}),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel.superclass.constructor.call(this,e)},doClose:function(){this.ownerCt.dialog.close()},doSave:function(){var e=this.shareWith.getStore().getAt(this.shareWith.selectedIndex);if(this.record)this.record.beginEdit(),e&&(this.record.set("type",this.type.getValue()),this.record.set("shareWith",e.data.shareWith),this.record.set("shareWithDisplayname",e.data.display_name)),this.record.set("permissionShare",this.permissionShare.getValue()),this.record.set("permissionChange",this.permissionChange.getValue()),this.record.set("permissionCreate",this.store.fileType===Zarafa.plugins.files.data.FileTypes.FOLDER&&this.permissionCreate.getValue()),this.record.set("permissionDelete",this.store.fileType===Zarafa.plugins.files.data.FileTypes.FOLDER&&this.permissionDelete.getValue()),this.record.endEdit();else{var t=new this.store.recordType({id:-1,type:this.type.getValue(),shareWith:e.data.shareWith,shareWithDisplayname:e.data.display_name,permissionCreate:this.store.fileType===Zarafa.plugins.files.data.FileTypes.FOLDER&&this.permissionCreate.getValue(),permissionChange:this.permissionChange.getValue(),permissionDelete:this.store.fileType===Zarafa.plugins.files.data.FileTypes.FOLDER&&this.permissionDelete.getValue(),permissionShare:this.permissionShare.getValue()});this.store.add(t)}this.ownerCt.dialog.close()},createPanelItems:function(){var e="user",t="",i=!1,a=!1,s=!1,r=!1;this.record&&(e=this.record.get("type"),t=this.record.get("shareWithDisplayname"),r=this.record.get("permissionShare"),a=this.record.get("permissionChange"),this.store.fileType===Zarafa.plugins.files.data.FileTypes.FOLDER&&(i=this.record.get("permissionCreate"),s=this.record.get("permissionDelete")));var n=[{xtype:"checkbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Re-share"),name:"permissionShare",ref:"../permissionShare",checked:r},{xtype:"checkbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Change"),name:"permissionChange",ref:"../permissionChange",checked:a}];return this.store.fileType===Zarafa.plugins.files.data.FileTypes.FOLDER&&n.push({xtype:"checkbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Create"),name:"permissionCreate",ref:"../permissionCreate",checked:i},{xtype:"checkbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Delete"),name:"permissionDelete",ref:"../permissionDelete",checked:s}),[{xtype:"filesplugin.seafile.usergrouppredictorfield",fieldLabel:dgettext("plugin_filesbackendSeafile","Share with"),name:"shareWith",ref:"shareWith",allowBlank:!1,value:t,recordId:this.recordId},{xtype:"selectbox",fieldLabel:dgettext("plugin_filesbackendSeafile","Type"),name:"type",ref:"type",allowBlank:!1,value:e,store:[["user","User"],["group","Group"]],mode:"local"},{xtype:"fieldset",title:dgettext("plugin_filesbackendSeafile","Permissions"),defaults:{labelWidth:89,anchor:"100%",xtype:"textfield"},items:n}]}}),Ext.reg("filesplugin.seafile.filesshareusereditpanel",Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserEditPanel),Ext.namespace("Zarafa.plugins.files.backend.Seafile.ui"),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGrid=Ext.extend(Ext.grid.GridPanel,{store:void 0,recordId:void 0,constructor:function(e){e=e||{},this.store=Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore.getStore(),Ext.applyIf(e,{xtype:"filesplugin.seafile.filesshareusergrid",ref:"sharegrid",store:this.store,border:!1,baseCls:"shareGrid",enableHdMenu:!1,loadMask:this.initLoadMask(),viewConfig:this.initViewConfig(),sm:this.initSelectionModel(),cm:this.initColumnModel(),listeners:{rowdblclick:this.onRowDblClick,scope:this},tbar:[{iconCls:"filesplugin_icon_add",text:dgettext("plugin_filesbackendSeafile","Add"),handler:this.onAdd.createDelegate(this)},"-",{iconCls:"filesplugin_icon_delete",text:dgettext("plugin_filesbackendSeafile","Delete"),ref:"../removeAccountBtn",disabled:!0,handler:this.onDelete.createDelegate(this)}]}),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGrid.superclass.constructor.call(this,e)},initLoadMask:function(){return{msg:dgettext("plugin_filesbackendSeafile","Loading users and groups")+"..."}},initViewConfig:function(){return{enableRowBody:!1,forceFit:!0,emptyText:"<div class='emptytext'>"+dgettext("plugin_filesbackendSeafile","Add users or groups to share files.")+"</div>",deferEmptyText:!1}},initSelectionModel:function(){return new Ext.grid.RowSelectionModel({singleSelect:!0,listeners:{selectionchange:this.onRowSelected}})},initColumnModel:function(){return new Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGridColumnModel({fileType:this.store.fileType})},onRowSelected:function(e){this.grid.removeAccountBtn.setDisabled(1!=e.getCount())},onRowDblClick:function(e,t){Zarafa.core.data.UIFactory.openLayerComponent(Zarafa.core.data.SharedComponentType["filesplugin.seafile.useredit"],void 0,{store:e.getStore(),record:e.getStore().getAt(t),manager:Ext.WindowMgr,recordId:this.recordId})},onAdd:function(e,t){Zarafa.core.data.UIFactory.openLayerComponent(Zarafa.core.data.SharedComponentType["filesplugin.seafile.useredit"],void 0,{store:this.store,manager:Ext.WindowMgr,recordId:this.recordId})},onDelete:function(e,t){var i=this.getSelectionModel().getSelected();if(!i)return!1;this.store.remove(i)}}),Ext.reg("filesplugin.seafile.filesshareusergrid",Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGrid),Ext.namespace("Zarafa.plugins.files.backend.Seafile.ui"),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGridColumnModel=Ext.extend(Zarafa.common.ui.grid.ColumnModel,{constructor:function(e){e=e||{},this.defaultColumns=this.createDefaultColumns(e.fileType),Ext.applyIf(e,{columns:this.defaultColumns,defaults:{sortable:!0}}),Ext.apply(this,e),Zarafa.plugins.files.backend.Seafile.ui.FilesShareUserGridColumnModel.superclass.constructor.call(this,e)},createDefaultColumns:function(e){var t=[{header:dgettext("plugin_filesbackendSeafile","Name"),dataIndex:"shareWithDisplayname",flex:1,sortable:!0,tooltip:dgettext("plugin_filesbackendSeafile","Sort by: Name")},{header:dgettext("plugin_filesbackendSeafile","Type"),dataIndex:"type",flex:1,align:"center",sortable:!0,renderer:this.shareTypeRenderer,tooltip:dgettext("plugin_filesbackendSeafile","Sort by: Type")},{header:dgettext("plugin_filesbackendSeafile","Share"),dataIndex:"permissionShare",flex:1,align:"center",sortable:!1,renderer:this.yesNoRenderer},{header:dgettext("plugin_filesbackendSeafile","Change"),dataIndex:"permissionChange",flex:1,align:"center",sortable:!1,renderer:this.yesNoRenderer}];return e===Zarafa.plugins.files.data.FileTypes.FOLDER&&t.push({header:dgettext("plugin_filesbackendSeafile","Create"),dataIndex:"permissionCreate",flex:1,align:"center",sortable:!1,renderer:this.yesNoRenderer},{header:dgettext("plugin_filesbackendSeafile","Delete"),dataIndex:"permissionDelete",flex:1,align:"center",sortable:!1,renderer:this.yesNoRenderer}),t},shareTypeRenderer:function(e,t,i){return t.css="shareicon_16_"+e,t.css+=" zarafa-grid-empty-cell",""},yesNoRenderer:function(e,t,i){return t.css=e?"shareicon_16_yes":"shareicon_16_no",t.css+=" zarafa-grid-empty-cell",""}}),Ext.namespace("Zarafa.plugins.files.backend.Seafile.ui"),Zarafa.plugins.files.backend.Seafile.ui.UserGroupPredictorField=Ext.extend(Ext.form.ComboBox,{constructor:function(e){var t=new Ext.data.ArrayStore({proxy:new Ext.data.HttpProxy({method:"GET",url:container.getBasePath()+"index.php"}),method:"GET",baseParams:{load:"custom",name:"files_get_recipients",id:e.recordId},id:1,fields:["display_name","shareWith","object_type"]});e=e||{},Ext.applyIf(e,{store:t,displayField:"display_name",typeAhead:!1,forceSelection:!0,triggerAction:"query",itemId:"predictor",mode:"remote",minChars:2,emptyText:dgettext("plugin_filesbackendSeafile","Type to search"),loadingText:dgettext("plugin_filesbackendSeafile","Loading..."),listEmptyText:dgettext("plugin_filesbackendSeafile","No results"),itemSelector:"div.ugpredic_search_item",tpl:new Ext.XTemplate('<tpl for=".">','<div class="ugpredic_search_item">',"<h3>",'<tpl if="object_type == Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.USER"><span><div class="shareicon_16_user">&nbsp;</div></span></tpl>','<tpl if="object_type == Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.GROUP"><span><div class="shareicon_16_group">&nbsp;</div></span></tpl>',"{display_name:htmlEncode}","</h3>","</div>","</tpl>","</tpl>"),onSelect:this.onSuggestionSelect,listeners:{invalid:this.onInvalid,scope:this}}),Zarafa.plugins.files.backend.Seafile.ui.UserGroupPredictorField.superclass.constructor.call(this,e)},onSuggestionSelect:function(e){this.setRawValue(e.get("display_name")),this.ownerCt.type.setValue(e.get("object_type")==Zarafa.plugins.files.backend.Seafile.data.RecipientTypes.USER?"user":"group"),this.collapse()},onInvalid:function(){this.isExpanded()&&(this.store.removeAll(),this.collapse())}}),Ext.reg("filesplugin.seafile.usergrouppredictorfield",Zarafa.plugins.files.backend.Seafile.ui.UserGroupPredictorField),Ext.namespace("Zarafa.plugins.files.backend.Seafile.data.singleton"),Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore=Ext.extend(Object,{store:void 0,init:function(e){this.store=new Zarafa.plugins.files.backend.Seafile.data.ShareGridStore(e)},addUser:function(e){var t=!1,i=!1,a=!1,s=!1;e.permissions-16>=1&&(s=!0,e.permissions-=16),e.permissions-8>=1&&(a=!0,e.permissions-=8),e.permissions-4>=1&&(t=!0,e.permissions-=4),e.permissions-2>=1&&(i=!0);var r=[e.id,e.shareWith,e.shareWithDisplayname,"user",t,i,a,s];this.store.loadData([r],!0)},addGroup:function(e){var t=!1,i=!1,a=!1,s=!1;e.permissions-16>=1&&(s=!0,e.permissions-=16),e.permissions-8>=1&&(a=!0,e.permissions-=8),e.permissions-4>=1&&(t=!0,e.permissions-=4),e.permissions-2>=1&&(i=!0);var r=[e.id,e.shareWith,e.shareWithDisplayname,"group",t,i,a,s];this.store.loadData([r],!0)},getStore:function(){return this.store}}),Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore=new Zarafa.plugins.files.backend.Seafile.data.singleton.ShareStore;
//# sourceMappingURL=filesbackendSeafile.min.js.map
